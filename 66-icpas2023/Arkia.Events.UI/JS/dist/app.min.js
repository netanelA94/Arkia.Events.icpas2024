jQuery.fn.exists=function(){return this.length>0};var errorValues=[],errorPage="./error",paymentPage="payment",closeErrorPage="./close-error",ARKIA={COMMON:{isIE8:function(){return $.browser.msie&&parseInt($.browser.version,10)<9},showMessageBox:function(a){$(".msgBox .content").empty();var b="<ul>";$.each(a,function(c){b+="<li>"+a[c]+"</li>"}),$(".msgBox .content").html(b),$(".bodyMain .msgBox").css("display","block")},isNotLogicalDate:function(a,b){return a=parseInt(a,10),(4==(b=parseInt(b,10))||6==b||9==b||11==b)&&31==a},isNotLogicalFeb29:function(a,b){var c=b%4==0&&(b%100!=0||b%400==0);return a>29||29==a&&!c},log:function(a){try{console.log(a)}catch(a){}},isFutureDate:function(a,b,c){return new Date(c,b-1,a,0,0,0,0)>new Date},isFutureDate6Month:function(a,b,c){var d=new Date(c,b-1,a,0,0,0,0),e=new Date;return e.setMonth(e.getMonth()+6),d>e},getOverlay:function(a,b){var c={color:"#213154",speed:500,opacity:.5,close:"geekster",closeOnClick:!1,closeOnEsc:!1,closeSpeed:0,onBeforeClose:null,load:!1,effect:"default"},b=$.extend(c,b);$(a).overlay({mask:{color:b.color,loadSpeed:b.speed,opacity:b.opacity},close:b.closeClass,closeOnClick:b.closeOnClick,closeOnEsc:b.closeOnEsc,closeSpeed:b.closeSpeed,onBeforeClose:b.onBeforeClose,load:b.load,effect:b.effect}),$(a).data("overlay").load()},closeOverlay:function(a){$(a).overlay().close()}},VALIDATE:{RE_EMAIL:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)/,RE_VALID_PHONE_COUNTRY:/^[0-9]{1,3}$/,RE_VALID_PHONE_AREA:/^[0-9]{1,3}$/,RE_VALID_PHONE_NUM:/^[0-9]{7}$/,RE_PASS_LEN:/^.{6,32}/,RE_WS:/\S/,validateID:function(a){if(a.length>0){for(var b=0,c=2,d=a.length-2;d>=0;d--){var e=c*parseInt(a.toString().charAt(d).toString());b+=parseInt(e/10)+parseInt(e%10),c=2==c?1:2}return(parseInt(a.toString().charAt(a.length-1).toString())+b)%10==0}return!1},isValidPhone:function(a){a[3]=$.trim(a[3]);var b=!0,c=/^[0-9]{2,3}/,d=/^[0-9]{1,3}/;return/^[0-9]{7}/.test(a[1])&&d.test(a[2])&&c.test(a[3])||(b=!1),b}}};Number.prototype.formatMoney=function(a,b,c){var d=this,a=isNaN(a=Math.abs(a))?2:a,b=void 0==b?".":b,c=void 0==c?",":c,e=d<0?"-":"",f=parseInt(d=Math.abs(+d||0).toFixed(a))+"",g=(g=f.length)>3?g%3:0;return e+(g?f.substr(0,g)+c:"")+f.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+c)+(a?b+Math.abs(d-f).toFixed(a).slice(2):"")},$(function(){$("#RGS02").exists()&&ARKIA.RGS02.init()}),ARKIA.RGS02={init:function(){$("input").keypress(function(a){if(13==a.which)return!1}),$('input[id$="txtRoommate1Area_code"]').keyfilter(/[0-9]/i),$('input[id$="txtRoommate2Area_code"]').keyfilter(/[0-9]/i),$('input[id$="txtRoommate1Phone"]').keyfilter(/[0-9]/i),$('input[id$="txtRoommate2Phone"]').keyfilter(/[0-9]/i),$('input[id$="txtRoommate1Name"]').keyfilter(/[א-תa-zA-Z\ ]/i),$('input[id$="txtRoommate2Name"]').keyfilter(/[א-תa-zA-Z\ ]/i),$('input[id$="txtRoommate1Id"]').keyfilter(/[0-9]/i),$('input[id$="txtRoommate2Id"]').keyfilter(/[0-9]/i),$('input[id*="rbCycle"]').attr("title",MSG435),$(".roommateArea_code").attr("aria-label",MSG434),$(".close").attr("aria-label",MSG426),$('input[type="radio"]').attr("name","rbLaps"),$('input[type="radio"]:disabled').attr("aria-disabled","true"),$('a[id$="btnContinue"]').bind("click",ARKIA.RGS02.onContinue),$(".bodyMain.ltr").length&&$(".phoneWrapper").attr("dir","rtl"),$(".lapWrapper li:has(.aspNetDisabled) .lapName").attr("style","color: red"),$(".roommateClear").click(function(){$(".roommatesRow input").val(""),$(".IdNoExists").css("display","none")}),$(".roommateClear").keydown(function(a){13==a.keyCode&&($(".roommatesRow input").val(""),$(".IdNoExists").css("display","none"))})},onContinue:function(){var a=!1;$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none");var b=new Array;$("input[name='rbLaps']:checked").val()||(b[b.length]=MSG39,$("input[name = 'rbLaps']").addClass("inputError"),$(".close",$(".msgBox")).click(function(){$(".msgBox").fadeOut("normal")}),a=!0),$('[id$="txtRoommate1Name"]:visible').length&&$.trim($('[id$="txtRoommate1Name"]').val()).length<2&&(b.push(MSG326),$('[id$="txtRoommate1Name"]').addClass("inputError"),a=!0),$('[id$="txtRoommate2Name"]:visible').length&&$.trim($('[id$="txtRoommate2Name"]').val()).length<2&&(b.push(MSG327),$('[id$="txtRoommate2Name"]').addClass("inputError"),a=!0);var c="000000000";if($(".roommatesRow.rr1 [id$='txtRoommate1Id']:visible").length&&($.trim($('input[id$="txtRoommate1Id"]').val()).length<1?(b.push(MSG238),$('input[id$="txtRoommate1Id"]').addClass("inputError"),a=!0):$.trim($('input[id$="txtRoommate1Id"]').val()).length>0&&!ARKIA.VALIDATE.validateID($.trim($('input[id$="txtRoommate1Id"]').val()))?(b.push(MSG238),$('input[id$="txtRoommate1Id"]').addClass("inputError"),a=!0):($('input[id$="txtRoommate1Id"]').val((c+$('input[id$="txtRoommate1Id"]').val()).slice(-c.length)),$.trim($('input[id$="txtRoommate1Id"]').val())===sessionStorage.getItem("CustomerID")&&(b.push(MSG420),$('input[id$="txtRoommate1Id"]').addClass("inputError"),a=!0))),$(".roommatesRow.rr2 [id$='txtRoommate2Id']:visible").length&&($.trim($('input[id$="txtRoommate2Id"]').val()).length<1?(b.push(MSG239),$('input[id$="txtRoommate2Id"]').addClass("inputError"),a=!0):$.trim($('input[id$="txtRoommate2Id"]').val()).length>0&&!ARKIA.VALIDATE.validateID($.trim($('input[id$="txtRoommate2Id"]').val()))?(b.push(MSG239),$('input[id$="txtRoommate2Id"]').addClass("inputError"),a=!0):($('input[id$="txtRoommate2Id"]').val((c+$('input[id$="txtRoommate2Id"]').val()).slice(-c.length)),$.trim($('input[id$="txtRoommate2Id"]').val())===sessionStorage.getItem("CustomerID")?(b.push(MSG421),$('input[id$="txtRoommate2Id"]').addClass("inputError"),a=!0):$.trim($('input[id$="txtRoommate2Id"]').val())==$.trim($('input[id$="txtRoommate1Id"]').val())&&(b.push(MSG422),$('input[id$="txtRoommate1Id"], input[id$="txtRoommate2Id"]').addClass("inputError"),a=!0))),a){$(".close",$(".msgBox")).click(function(){return $(".msgBox").fadeOut("normal"),$(".actionBar .content").attr("tabindex","-1"),!1}),ARKIA.COMMON.showMessageBox(b);return $(window).width()>1024?(setTimeout(function(){$(".actionBar .content").attr("tabindex","0"),$(".actionBar .content").focus()},100),$(".actionBar .content").keydown(function(a){9!=a.keyCode||a.shiftKey||$(".inputError").length>0&&($(".inputError:first").focus(),a.preventDefault())})):($(".actionBar .content").removeAttr("role"),setTimeout(function(){$(".actionBar .content").attr("role","alert"),$(".actionBar .content").focus()},100),setTimeout(function(){$(".inputError").length>0&&$(".inputError:first").focus()},5e3)),!1}var d=$("input[name='rbLaps']:checked").parent().attr("data-cycleid");return $('input[id$="hfSelectedCycle"]').val(d),!0}},$(function(){$("#PMN04").exists()&&ARKIA.PMN04.init()}),ARKIA.PMN04={init:function(){var a=sessionStorage.getItem("userEmail");a&&$("#txtDocsToMail").val(a),$("#hlGetDocsByMail").click(function(){jQuery.browser.mobile&&$("#sendDocsDialog").addClass("absolute"),ARKIA.COMMON.getOverlay($("#sendDocsDialog"),{close:"dialogBoxClose",closeOnClick:!0,closeOnEsc:!0}),$("#sendDocsDialog a.close").attr("tabindex","0"),$("#sendDocsDialog a.close").attr("aria-label","סגור"),$("#sendDocsDialog a.close").focus(),$("#sendDocsDialog a.close").keydown(function(a){9==a.keyCode&&a.shiftKey&&($("#sendDocsDialog #btnSendDocs").focus(),a.preventDefault())}),$("#sendDocsDialog #btnSendDocs").keydown(function(a){9!=a.keyCode||a.shiftKey||($("#sendDocsDialog a.close").focus(),a.preventDefault())})}),$("#btnSendDocs").click(function(){$("#validBox").hide();var a=$.trim($("#txtDocsToMail").val());if(!a)return $("#txtDocsToMail").focus(),$("#validBox").show(),!1;if(!ARKIA.VALIDATE.RE_EMAIL.test(a))return $("#txtDocsToMail").focus(),$("#validBox").show(),!1;var b={reservationsn:reservationSn,email:a};$.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/SendEmailDocs",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){},error:function(a,b,c){}}),$("#sendDocsDialog").overlay().close()})}},$(function(){$("#RGS01").exists()&&ARKIA.LOGIN.init()}),ARKIA.LOGIN={init:function(){$("input").keypress(function(a){if(13==a.which)return!1}),$('input[id$="txtID"]').keyfilter(/[0-9]/i),$(".txtLogin:first").focus(),$(".close").attr("aria-label",MSG426),$('a[id$="btnContinue"]').click(ARKIA.LOGIN.onContinue),sessionStorage.clear();for(var a=new Array,b=new Array,c=new Array,d=(new Date).getFullYear(),e=0,f=d-12;f>d-88;f--)a[e]=f,e++;for(var f=1;f<13;f++)b[f-1]=f;for(var f=1;f<32;f++)c[f-1]=f;$.each(a,function(a,b){$(".ddlYears").append($("<option></option>").attr("value",b).text(b))}),$.each(b,function(a,b){$(".ddlMonthes").append($("<option></option>").attr("value",b).text(b))}),$.each(c,function(a,b){$(".ddlDays").append($("<option></option>").attr("value",b).text(b))}),(window.location.href.indexOf("dev")>-1||window.location.href.indexOf("192.168.84.25")>-1)&&($('input[id$="txtID"]').val(36038099),$('input[id$="txtLicense"]').val(23985),$(".ddlDays").val("4"),$(".ddlMonthes").val("11"),$(".ddlYears").val("1979"))},onContinue:function(){var a=!1;$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none");var b=new Array;ARKIA.VALIDATE.validateID($.trim($('input[id$="txtID"]').val()))||(b[b.length]=MSG45,$('input[id$="txtID"]').addClass("inputError"),a=!0);var c="000000000";$('input[id$="txtID"]').val((c+$('input[id$="txtID"]').val()).slice(-c.length));var d=$(".ddlYears option:selected"),e=$(".ddlMonthes option:selected"),f=$(".ddlDays option:selected");if(d.val()<"0"||e.val()<"0"||f.val()<"0"?(a=!0,d.val()<"0"&&d.addClass("inputError"),e.val()<"0"&&e.addClass("inputError"),f.val()<"0"&&f.addClass("inputError"),b[b.length]=MSG123):ARKIA.COMMON.isNotLogicalDate(f.children(":selected").text(),e.children(":selected").text())&&(a=!0,f.addClass("inputError"),e.addClass("inputError"),b[b.length]=MSG123),f.children(":selected").text()>=29&&2==e.children(":selected").text()&&ARKIA.COMMON.isNotLogicalFeb29(f.children(":selected").text(),d.children(":selected").text())&&(a=!0,f.addClass("inputError"),e.addClass("inputError"),b[b.length]=MSG123),a){$(".close",$(".msgBox")).click(function(){return $(".msgBox").fadeOut("normal"),$(".actionBar .content").attr("tabindex","-1"),!1}),ARKIA.COMMON.showMessageBox(b);return $(window).width()>1024?(setTimeout(function(){$(".actionBar .content").attr("tabindex","0"),$(".actionBar .content").focus()},100),$(".actionBar .content").keydown(function(a){9!=a.keyCode||a.shiftKey||($(".inputError:first").focus(),a.preventDefault())})):($(".actionBar .content").removeAttr("role"),setTimeout(function(){$(".actionBar .content").attr("role","alert"),$(".actionBar .content").focus()},100),setTimeout(function(){$(".inputError:first").focus()},5e3)),!1}sessionStorage.setItem("CustomerID",$.trim($('input[id$="txtID"]').val()));var g=d.val(),h=e.val(),i=f.val(),j=(i<10?"0"+i:i)+"/"+(h<10?"0"+h:h)+"/"+g;$('input[id$="hfDob"]').val(j)}},$(function(){$("#PMN02").exists()&&ARKIA.PAYMENT.init()}),ARKIA.PAYMENT={init:function(){$("#txtCardHolderName").keyfilter(/[a-zA-Zא-ת .-]+/),$("#txtInvoiceCustomerName").keyfilter(/[a-zA-Zא-ת .-]+/),$("#txtVatCaseRefNo").keyfilter(/[0-9]/i),$(".txtTokenVal").keyfilter(/[0-9]/i),$("#hfBalancePrice").val(parseInt($(".balancePrice").attr("data-amount"))),window.setTimeout(function(){$.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/CancelReservation",data:"{reservationSn:'"+reservationSn+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){a.d;window.location="http://"+location.hostname+"/"+APPFolfer+"/form-wizard",alert(MSG81)},error:function(a,b,c){window.location="http://"+location.hostname+"/"+APPFolfer+"/"+errorPage}})},9e5);var a=function(){$("#txtCCNumberPCI").unbind("click",a);var b=$("#txtCardHolderName");if($(".inputError").removeClass("inputError"),$(".msgBox").css("display","none"),$.trim(b.val()).length<4){var c=new Array;c.push(MSG94),b.addClass("inputError"),ARKIA.COMMON.showMessageBox(c),setTimeout(function(){$(".actionBar .content").attr("tabindex","0"),$(".actionBar .content").focus()},100),$(".actionBar .content").keydown(function(a){9!=a.which||a.shiftKey||($(".inputError:first").focus(),a.preventDefault())}),$("#txtCCNumberPCI").bind("click",a),$("#txtCCNumberPCI").keydown(function(a){13==a.which&&$("#txtCCNumberPCI").click()})}else $.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/GetPCIUrl",data:"{customerName:'"+$.trim(b.val())+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(b){var c=b.d;null!=c&&0==c.ReturnCode&&null!=c.Url&&"null"!=c.Url?($("#pciIframe").attr("src",c.Url),jQuery.browser.mobile&&$("#pciDialog").addClass("absolute"),ARKIA.COMMON.getOverlay($("#pciDialog"),{close:"dialogBoxClose",closeOnClick:!1,onBeforeClose:function(){$("#txtCCNumberPCI").bind("click",a),$("#txtCCNumberPCI").keydown(function(a){13==a.which&&$("#txtCCNumberPCI").click()})},closeOnEsc:!1}),$("#pciDialog .close").click(function(){$("#ddlPaymentsNum").focus()}),$("#pciDialog a.close").attr("tabindex","0"),$("#pciDialog a.close").attr("aria-label",MSG426),$("#pciDialog a.close").focus(),$("#pciDialog a.close").keydown(function(a){9==a.keyCode&&a.shiftKey&&a.preventDefault()}),$("#pciDialog").focusout(function(){$(this).find("a.close").focus()})):(alert(MSG92),$("#txtCCNumberPCI").bind("click",a),$("#txtCCNumberPCI").keydown(function(a){13==a.which&&$("#txtCCNumberPCI").click()}))},error:function(b,c,d){return alert(MSG92),$("#txtCCNumberPCI").bind("click",a),$("#txtCCNumberPCI").keydown(function(a){13==a.which&&$("#txtCCNumberPCI").click()}),!1}})};if($("#txtCCNumberPCI").bind("click",a),$("#txtCCNumberPCI").keydown(function(a){13==a.which&&$("#txtCCNumberPCI").click()}),pricePlans.Value.length>1)for(var b=1;b<=3&&b<=pricePlans.Value[1].MAX_PAYMENTS_NO;b++)$("#ddlPaymentsNum").append("<option value="+b+">"+b+"</option>");else $(".paymentRow.paymentsNum").css("display","none");var c=!0;$("#hlotherPayment").click(function(){$("#hfToken").val(""),$("#hfTxnToken").val(""),$("#txtCCNumberPCI").val(""),$("#txtCardHolderName").val(""),$("#ddlPaymnetMethod").val(""),$("#ddlPaymnetMethod").val($("#ddlPaymnetMethod option:first").val()),$("#ddlPaymentsNum").val($("#ddlPaymentsNum option:first").val()),$("#txtVatCaseRefNo").val(""),$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none"),$("#hlPayment").add("#otherPaymentMethodsBox").add("#btnOtherPayment").add("#titleText").show(),$("#hlotherPayment").add("#invoicePropBox").add("#btnPayment").add("#titleCcText").add("#ccPaymentInfoBox").hide(),c=!1}),$("#hlPayment").click(function(){$("#hfToken").val(""),$("#hfTxnToken").val(""),$("#txtCCNumberPCI").val(""),$("#txtCardHolderName").val(""),$("#ddlPaymnetMethod").val($("#ddlPaymnetMethod option:first").val()),$("#ddlPaymentsNum").val($("#ddlPaymentsNum option:first").val()),$("#txtInvoiceCustomerName").val(""),$("#txtVatCaseRefNo").val(""),$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none"),$("#hlPayment").add("#otherPaymentMethodsBox").add("#btnOtherPayment").add("#titleText").hide(),$("#hlotherPayment").add("#invoicePropBox").add("#btnPayment").add("#titleCcText").add("#ccPaymentInfoBox").show(),c=!0}),$(".close",$(".msgBox")).click(function(){return $(".msgBox").fadeOut("normal"),$(".actionBar .content").attr("tabindex","-1"),!1}),$(".txtTokenVal").blur(function(){var a=parseInt($(this).attr("data-TOKEN_DUE"));if(parseInt($(this).val())>a)return alert(MSG351),void $(this).val(0)}),$("#updateTokenLink").click(function(){var a=parseInt($(".balancePrice").attr("data-amount")),b=0;if($(".txtTokenVal").each(function(){$(this).val()&&(b+=parseInt($(this).val()))}),b>a)return void alert(MSG350);b>=a?($("#paymentByCCBox").hide(),c=!1):($("#paymentByCCBox").show(),c=!0),$("#hfBalancePrice").val(a-b),$(".balancePrice span").text(eventsCurrency+(a-b).formatMoney(0,".",","))}),$("#btnPayment").add("#btnOtherPayment").click(function(){if($("#tokensList").length){var a=parseInt($(".balancePrice").attr("data-amount")),b=0;if($(".txtTokenVal").each(function(){$(this).val()&&(b+=parseInt($(this).val()))}),a-b!=parseInt($("#hfBalancePrice").val()))return void alert(MSG352)}$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none");var d=new Array;if($("#paymentByCCBox").is(":visible")?($.trim($("#txtCardHolderName").val()).length<4&&(d.push(MSG94),$("#txtCardHolderName").addClass("inputError")),($.trim($("#hfTxnToken").val()).length<4||$.trim($("#hfTxnToken").val()).length<4)&&(d.push(MSG98),$("#txtCCNumberPCI").addClass("inputError")),c?$.trim($("#txtInvoiceCustomerName").val()).length>1&&($.trim($("#txtInvoiceCustomerName").val()).length<4?(d.push(MSG96),$("#txtInvoiceCustomerName").addClass("inputError")):$.trim($("#txtVatCaseRefNo").val()).length<2&&(d.push(MSG97),$("#txtVatCaseRefNo").addClass("inputError"))):$("input[name=paymentType]:checked").val()||(d.push(MSG99),$("input[name=paymentType]").addClass("inputError"))):c=!1,d.length>0)return ARKIA.COMMON.showMessageBox(d),setTimeout(function(){$(".actionBar .content").attr("tabindex","0"),$(".actionBar .content").focus()},100),$(".actionBar .content").keydown(function(a){9!=a.which||a.shiftKey||($(".inputError:first").focus(),a.preventDefault())}),!1;$(this).hide(),$("#loader").show();var e="",f=!1;$("#tokensList").length&&(f=!0,e="<M_PAYMENT_TOKENS>",$(".txtTokenVal").each(function(){if($(this).val()){var a=parseInt($(this).val()),b=parseFloat($(this).attr("data-EXCHANGE_RATE"));a>0&&(e+="<O_PAYMENT_TOKEN>",0!=b&&(a/=b),e+="<PAYMENT_AMOUNT>"+a+"</PAYMENT_AMOUNT>",e+="<TOKENSN>"+$(this).attr("data-TOKENSN")+"</TOKENSN>",e+="<CURRENCY_CODE>"+$(this).attr("data-CURRENCY_CODE")+"</CURRENCY_CODE>",e+="</O_PAYMENT_TOKEN>")}}),e+="</M_PAYMENT_TOKENS>");var g={reservationsn:reservationSn,paymentByCc:c,token:$("#hfToken").val()?$("#hfToken").val():"",txnToken:$("#hfTxnToken").val()?$("#hfTxnToken").val():"",cardOwnerName:$("#txtCardHolderName").val()?$("#txtCardHolderName").val():"",ccPlanNo:1==pricePlans.Value.length||pricePlans.Value.length>1&&1==$("#ddlPaymentsNum").val()?pricePlans.Value[0].PLAN_CODE:pricePlans.Value.length>1?pricePlans.Value[1].PLAN_CODE:0,cvv:$("#txtCvv").val()?$("#txtCvv").val():0,paymentsNo:1==pricePlans.Value.length?1:pricePlans.Value.length>1?$("#ddlPaymentsNum").val():0,pmtTokensXml:e,invoiceCustomerName:c&&$("#txtInvoiceCustomerName").val()?$("#txtInvoiceCustomerName").val():null,vatCaseRefNo:c&&$("#txtVatCaseRefNo").val()?$("#txtVatCaseRefNo").val():null,invoiceEmailSend:c&&$("#txtInvoiceEmailSend").val()?$("#txtInvoiceEmailSend").val():null,formOfPayment:c||f?null:$("input[name=paymentType]:checked").val()};$.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/DoPayment",data:JSON.stringify(g),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){var b=a.d;window.location="http://"+location.hostname+"/"+APPFolfer+"/tnx?r="+reservationSn+"&ca="+b.ContinueAction},error:function(a,b,c){window.location="http://"+location.hostname+"/"+APPFolfer+"/"+errorPage,console.log(c)}})})},setToken:function(a,b,c,d,e,f){console.info("ora: errCode: "+a+" msg: "+e+" session:"+f);var g=$("#hfTxnToken"),h=$("#hfToken");0==a?($("#pciDialog").overlay().close(),$("#txtCvv").focus(),g.val(c),h.val(b),$("#txtCCNumberPCI").val("************"+b.substr(b.length-4)),$("#paymentPCIError").hide()):($("#txtCCNumberPCI").val(""),g.val(""),h.val(""),$("#pciIframe").attr("src",d),$("#paymentPCIError").show())}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.init()}),ARKIA.WIZARD={init:function(){$("#menu li > a").each(function(a){$(this).attr("href","#step-"+(a+1))}),$("#wizardContent .stepContent").each(function(a){$(this).attr("id","step-"+(a+1))}),$("#wizard").smartWizard({selected:0,keyNavigation:!1,enableAllSteps:!1,updateHeight:!1,transitionEffect:"fade",contentURL:null,contentCache:!0,cycleSteps:!1,enableFinishButton:!1,errorSteps:[],labelNext:"הבא",labelPrevious:"הקודם",labelFinish:"סיום",onLeaveStep:ARKIA.WIZARD.leaveAStepCallback,onShowStep:ARKIA.WIZARD.showAStepCallback,onFinish:ARKIA.WIZARD.onFinishCallback}),$("#wizardLoader").hide(),$("#wizardContent").show()},wizardCtrl:["$scope","$window",function(a,b){a.init=function(){c()},$(window).resize(function(){var d=a.xs?"xs":a.sm?"sm":a.md?"md":"lg";c(),d!=(a.xs?"xs":a.sm?"sm":a.md?"md":"lg")&&b.location.reload()});var c=function(){a.xs=a.sm=a.md=a.lg=!1;var b=$(window).width();b<768?a.xs=!0:b<992?a.sm=!0:b<1200?a.md=!0:a.lg=!0}}],leaveAStepCallback:function(a){var b=a.attr("rel"),c=a.attr("data-stepPage");return ARKIA.WIZARD.validateSteps(c,b)},showAStepCallback:function(a){var b=a.attr("rel"),c=a.attr("data-stepPage");switch($("#wizard").smartWizard("unVisitSteps",{stepnum:b}),c){case"RGS03":angular.element(document.getElementById("ng_Ctrl_RGS03")).scope().init(),angular.element(document.getElementById("ng_Ctrl_RGS03")).scope().$apply();break;case"RGS04":angular.element(document.getElementById("ng_Ctrl_RGS04")).scope().init(),angular.element(document.getElementById("ng_Ctrl_RGS04")).scope().$apply();break;case"RGS05":angular.element(document.getElementById("ng_Ctrl_RGS05")).scope().init(),angular.element(document.getElementById("ng_Ctrl_RGS05")).scope().$apply();break;case"PRD01":angular.element(document.getElementById("ng_Ctrl_PRD01")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD01")).scope().$apply(),$("#PRD01").show(),$("#PRD02").hide();break;case"PRD03":angular.element(document.getElementById("ng_Ctrl_PRD03")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD03")).scope().$apply(),$("#PRD03").show(),$("#PRD04").hide();break;case"PRD09":angular.element(document.getElementById("ng_Ctrl_PRD09")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD09")).scope().$apply(),$("#shuttlePart1").show(),$("#shuttlePart2").hide();break;case"PRD05":angular.element(document.getElementById("ng_Ctrl_PRD05")).scope().init($("#ng_Ctrl_PRD05"),"PRD05"),angular.element(document.getElementById("ng_Ctrl_PRD05")).scope().$apply(),$("#addPrdPart1PRD05").show(),$("#addPrdPart2PRD05").hide();break;case"PRD06":angular.element(document.getElementById("ng_Ctrl_PRD06")).scope().init($("#ng_Ctrl_PRD06"),"PRD06"),angular.element(document.getElementById("ng_Ctrl_PRD06")).scope().$apply(),$("#addPrdPart1PRD06").show(),$("#addPrdPart2PRD06").hide();break;case"PRD07":angular.element(document.getElementById("ng_Ctrl_PRD07")).scope().init($("#ng_Ctrl_PRD07"),"PRD07"),angular.element(document.getElementById("ng_Ctrl_PRD07")).scope().$apply(),$("#addPrdPart1PRD07").show(),$("#addPrdPart2PRD07").hide();break;case"PRD13":angular.element(document.getElementById("ng_Ctrl_PRD13")).scope().init($("#ng_Ctrl_PRD13"),"PRD13"),angular.element(document.getElementById("ng_Ctrl_PRD13")).scope().$apply(),$("#mealsPart1").show(),$("#mealsPart2").hide();break;case"PMN01":angular.element(document.getElementById("ng_Ctrl_PMN01")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PMN01")).scope().$apply()}return!0},onFinishCallback:function(){if(ARKIA.WIZARD.validateAllSteps()){"PMN01"==obj.attr("data-stepPage")&&($("#wizard").smartWizard("showMessage","Finish Clicked"),$("form").submit())}},validateSteps:function(a,b){var c=!0;new Array;switch($(".inputError").removeClass("inputError"),a){case"RGS03":c=ARKIA.WIZARD.REGISTRATION.ValidateStep(b);break;case"RGS04":c=ARKIA.WIZARD.COMPANIONS.ValidateStep(b);break;case"RGS05":c=ARKIA.WIZARD.FEES.ValidateStep(b);break;case"PRD01":c=ARKIA.WIZARD.HOTELS.ValidateStep(b);break;case"PRD03":c=ARKIA.WIZARD.FLIGHTS.ValidateStep(b);break;case"PRD09":c=ARKIA.WIZARD.SHUTTLE.ValidateStep(b);break;case"PRD05":c=ARKIA.WIZARD.PRODUCTS.PRD05.ValidateStep(b);break;case"PRD06":c=ARKIA.WIZARD.PRODUCTS.PRD06.ValidateStep(b);break;case"PRD07":c=ARKIA.WIZARD.PRODUCTS.PRD07.ValidateStep(b);break;case"PRD08":c=ARKIA.WIZARD.PRODUCTS.PRD08.ValidateStep(b);break;case"PRD13":c=ARKIA.WIZARD.MEALS.PRD13.ValidateStep(b)}return ARKIA.WIZARD.setError(b,!c),window.scrollTo(0,170),c},createErrorListWizard:function(a){var b="<ul>";return $.each(a,function(c){b+="<li>"+a[c]+"</li>"}),$(window).width()>1024?setTimeout(function(){$(".actionBar .content").attr("tabindex","0"),$(".actionBar .content").focus()},100):($(".actionBar .content").removeAttr("role"),setTimeout(function(){$(".actionBar .content").attr("role","alert"),$(".actionBar .content").focus()},100)),b+"</ul>"},validateAllSteps:function(){return!0},setError:function(a,b){$("#wizard").smartWizard("setError",{stepnum:a,iserror:b}),b?$("#wizard").smartWizard("showMessage",errorValues[a]):$(".msgBox").css("display","none")}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.REGISTRATION.init()}),ARKIA.WIZARD.REGISTRATION={reLoad:!0,registrationCtrl:["$scope",function(a){a.init=function(){if(ARKIA.WIZARD.REGISTRATION.reLoad){$(".skip.mainContent1").attr("style","display:none;"),$(".skip.mainContent2").attr("style","display:block;"),$(".skip.topMenu").attr("style","display:block;"),null!==sessionStorage.getItem("CustomerID")&&sessionStorage.getItem("CustomerID").length>1&&$("[role='ID_NO']").val(sessionStorage.getItem("CustomerID"));for(var b=new Array,c=new Array,d=new Array,e=(new Date).getFullYear(),f=0,g=e-12;g>e-88;g--)b[f]=g,f++;for(var g=1;g<13;g++)c[g-1]=g;for(var g=1;g<32;g++)d[g-1]=g;a.cmdtitles=[],$.each(titlesData,function(b,c){a.cmdtitles.push({cmdtitle:c.Name,value:c.Id})}),a.cmdjobtitles=[],$.each(jobTitlesData,function(b,c){a.cmdjobtitles.push({cmdjobtitle:c.Name,value:c.Id})}),a.cmdyears=b,a.cmdmonths=c,a.cmddays=d;for(var e=(new Date).getFullYear(),b=new Array,f=0,g=e-5;g<e+11;g++)b[f]=g,f++;a.cmdPyears=b,a.cmdPmonths=c,a.cmdPdays=d,0!=regTypeCode&&$("#divCPA").hide(),ARKIA.WIZARD.REGISTRATION.reLoad=!1,(window.location.href.indexOf("dev")>-1||window.location.href.indexOf("192.168.84.25")>-1)&&($("#lastname_eng").val("test"),$("#firstname_eng").val("test"),$(".emailDetails").val("test@test.com"),$(".phoneDetails").val("1234567"),$(".area_codeDetails").val("073"),$(".firstnameDetails").val("אלמוני"),$(".lastnameDetails").val("פלוני"),$("#title").val(1),$("#passport").val(1234567890),$("#passportYear").val(2020),$("#passportMonth").val(12),$("#passportDay").val(17),$("#DOBYear").val(1980),$("#DOBMonth").val(7),$("#DOBDay").val(25))}}}],init:function(){ARKIA.WIZARD.REGISTRATION.autofillInputs(),ARKIA.WIZARD.REGISTRATION.initKeyfilter(),ARKIA.WIZARD.REGISTRATION.initDescriptions(),hasRoommate?$("#buttonNextDetails").attr("jumpStep",!0):$("#buttonNextDetails").removeAttr("jumpStep"),$(".close").attr("aria-label",MSG426)},autofillInputs:function(){var a=ARKIA2.WIZARD.getReservation();if(null!==a)for(var b in a.CUSTOMER)a.CUSTOMER.hasOwnProperty(b)&&$("[role='"+b+"']").val(a.CUSTOMER[b]);$("#id").attr("disabled","disabled")},initKeyfilter:function(){$(".lastnameDetails").keyfilter(/[א-ת\'\ ]/i),$(".firstnameDetails").keyfilter(/[א-ת\'\ ]/i),$("#lastname_eng").keyfilter(/[a-zA-Z\ ]/i),$("#firstname_eng").keyfilter(/[a-zA-Z\ ]/i),$(".emailDetails").keyfilter(/[a-z0-9_\.\-@]/i),$(".phoneDetails").keyfilter(/[0-9]/i),$("#phone_ext").keyfilter(/[0-9]/i),$("#fax").keyfilter(/[0-9]/i),$(".area_codeDetails").keyfilter(/[0-9]/i),$("#area_code_ext").keyfilter(/[0-9]/i),$("#area_code_fax").keyfilter(/[0-9]/i),$("#passport").keyfilter(/[0-9]/i)},initDescriptions:function(){$("[role='TITLE_CODE']").attr("aria-label",MSG443),$("[role='JOB_TITLE_CODE']").attr("aria-label",MSG444),$("[role='YEAR']").attr("aria-label",MSG427),$("[role='MONTH']").attr("aria-label",MSG428),$("[role='DAY']").attr("aria-label",MSG429),$("[role='PASSPORT_YEAR']").attr("aria-label",MSG430),$("[role='PASSPORT_MONTH']").attr("aria-label",MSG431),$("[role='PASSPORT_DAY']").attr("aria-label",MSG432),$(".area_codeDetails").attr("aria-label",MSG434),$("#area_code_ext").attr("aria-label",MSG441),$("#area_code_fax").attr("aria-label",MSG442),$("#ng_Ctrl_RGS03 input:disabled").attr("aria-disabled","true")},ValidateStep:function(a){(window.location.href.indexOf("dev")>-1||window.location.href.indexOf("192.168.84.25")>-1)&&($("#title").val("1"),$("#passport").val(1234567890),$("#passportYear").val(10),$("#passportMonth").val(10),$("#passportDay").val(15),$("#DOBYear").val(33),$("#DOBMonth").val(7),$("#DOBDay").val(25));var b=!0,c=new Array;if(""==$("#title").children(":selected").val()&&(b=!1,$("#title").addClass("inputError"),c[c.length]=MSG40),$.trim($(".lastnameDetails").val()).length<2&&(b=!1,$(".lastnameDetails").addClass("inputError"),c[c.length]=MSG41),$.trim($(".firstnameDetails").val()).length<2&&(b=!1,$(".firstnameDetails").addClass("inputError"),c[c.length]=MSG42),$.trim($(".phoneDetails").val()).length<7&&(b=!1,$(".phoneDetails").addClass("inputError"),c[c.length]=MSG43),$.trim($(".area_codeDetails").val()).length<1)b=!1,$(".area_codeDetails").addClass("inputError"),$.trim($(".phoneDetails").val()).length>6&&(c[c.length]=MSG43);else{var d=$.trim($(".area_codeDetails").val())+$.trim($(".phoneDetails").val());d===sessionStorage.getItem("PhoneRoomate1")?(b=!1,$(".area_codeDetails, .phoneDetails").addClass("inputError"),c[c.length]=MSG439):d===sessionStorage.getItem("PhoneRoomate2")&&(b=!1,$(".area_codeDetails, .phoneDetails").addClass("inputError"),c[c.length]=MSG440)}$.trim($(".emailDetails").val()).length<5?(b=!1,$(".emailDetails").addClass("inputError"),c[c.length]=MSG44):ARKIA.VALIDATE.RE_EMAIL.test($.trim($(".emailDetails").val()))||(b=!1,$(".emailDetails").addClass("inputError"),c[c.length]=MSG44),$.trim($("#lastname_eng").val()).length<2&&(b=!1,$("#lastname_eng").addClass("inputError"),c[c.length]=MSG46),$.trim($("#firstname_eng").val()).length<2&&(b=!1,$("#firstname_eng").addClass("inputError"),c[c.length]=MSG47);var e=/[a-zA-Z\ ]/i;$.trim($('input[id$="firstname_eng"]').val()).length>0&&(e.test($.trim($('input[id$="firstname_eng"]').val()))||(b=!1,$("#firstname_eng").addClass("inputError"),c[c.length]=MSG390)),$.trim($('input[id$="lastname_eng"]').val()).length>0&&(e.test($.trim($('input[id$="lastname_eng"]').val()))||(b=!1,$("#lastname_eng").addClass("inputError"),c[c.length]=MSG391));var f=/^[א-ת\'\-\(\) ]*$/;$.trim($(".firstnameDetails").val()).length>0&&(f.test($.trim($(".firstnameDetails").val()))||(b=!1,$(".firstnameDetails").addClass("inputError"),c[c.length]=MSG394)),$.trim($(".lastnameDetails").val()).length>0&&(f.test($.trim($(".lastnameDetails").val()))||(b=!1,$(".lastnameDetails").addClass("inputError"),c[c.length]=MSG395)),($.trim($("#phone_ext").val()).length>0||$.trim($("#area_code_ext").val()).length>0)&&($.trim($("#phone_ext").val()).length<7&&(b=!1,$("#phone_ext").addClass("inputError"),c[c.length]=MSG48),$.trim($("#area_code_ext").val()).length<1&&(b=!1,$("#area_code_ext").addClass("inputError"),$.trim($("#phone_ext").val()).length>6&&(c[c.length]=MSG48))),""==$("#CPA").children(":selected").val()&&0==regTypeCode&&(b=!1,$("#CPA").addClass("inputError"),c[c.length]=MSG370);var g=$("#passport").length;if(g){$.trim($("#passport").val()).length<6&&(b=!1,$("#passport").addClass("inputError"),c[c.length]=MSG316);var h=$("#passportYear"),i=$("#passportMonth"),j=$("#passportDay");h.val()<"0"||i.val()<"0"||j.val()<"0"?(b=!1,h.val()<"0"&&h.addClass("inputError"),i.val()<"0"&&i.addClass("inputError"),j.val()<"0"&&j.addClass("inputError"),c[c.length]=MSG317):ARKIA.COMMON.isNotLogicalDate(j.children(":selected").text(),i.children(":selected").text())&&(b=!1,j.addClass("inputError"),i.addClass("inputError"),c[c.length]=MSG317),j.children(":selected").text()>=29&&2==i.children(":selected").text()&&ARKIA.COMMON.isNotLogicalFeb29(j.children(":selected").text(),h.children(":selected").text())&&(b=!1,j.addClass("inputError"),i.addClass("inputError"),c[c.length]=MSG317);var k=$("#DOBYear"),l=$("#DOBMonth"),m=$("#DOBDay");k.val()<"0"||l.val()<"0"||m.val()<"0"?(b=!1,k.val()<"0"&&k.addClass("inputError"),l.val()<"0"&&l.addClass("inputError"),m.val()<"0"&&m.addClass("inputError"),c[c.length]=MSG322):ARKIA.COMMON.isNotLogicalDate(m.children(":selected").text(),l.children(":selected").text())&&(b=!1,m.addClass("inputError"),l.addClass("inputError"),c[c.length]=MSG322),m.children(":selected").text()>=29&&2==l.children(":selected").text()&&ARKIA.COMMON.isNotLogicalFeb29(m.children(":selected").text(),k.children(":selected").text())&&(b=!1,m.addClass("inputError"),l.addClass("inputError"),c[c.length]=MSG322)}if(b){if(g){ARKIA.COMMON.isFutureDate6Month(j.children(":selected").text(),i.children(":selected").text(),h.children(":selected").text())||alert(MSG336),sessionStorage.setItem("userEmail",$(".emailDetails").val());var n=new Date(h.children(":selected").text(),parseInt(i.children(":selected").text())-1,j.children(":selected").text())}"7"==$("#CPA").children(":selected").val()&&0==regTypeCode&&alert(MSG371),null===ARKIA.RESERVATION.CUSTOMER||$("#lastname_eng").val().toLowerCase()==ARKIA.RESERVATION.CUSTOMER.LATIN_LAST_NAME.toLowerCase()&&$("#firstname_eng").val().toLowerCase()==ARKIA.RESERVATION.CUSTOMER.LATIN_FIRST_NAME.toLowerCase()||(ARKIA2.WIZARD.resetCompanions(!0),ARKIA.WIZARD.FEES.reLoad=ARKIA.WIZARD.FLIGHTS.reLoad=ARKIA.WIZARD.HOTELS.reLoad=ARKIA.WIZARD.HOTELS.reLoad2=ARKIA.WIZARD.PRODUCTS.PRD05.reLoad=ARKIA.WIZARD.PRODUCTS.PRD06.reLoad=ARKIA.WIZARD.PRODUCTS.PRD07.reLoad=ARKIA.WIZARD.MEALS.PRD13.reLoad=ARKIA.WIZARD.COMPANIONS.reLoad=!0),ARKIA2.WIZARD.setCustomer(""!=$("#title").val()?$("#title").val():0,""!=$("#jobtitle").val()?$("#jobtitle").val():0,$(".idDetails").val(),$(".lastnameDetails").val(),$(".firstnameDetails").val(),$("#lastname_eng").val(),$("#firstname_eng").val(),$.trim($(".emailDetails").val()),$(".area_codeDetails").val(),$(".phoneDetails").val(),$("#area_code_ext").val(),$("#phone_ext").val(),$("#area_code_fax").val()?$("#area_code_fax").val():null,$("#fax").val()?$("#fax").val():null,g?$("#passport").val():null,g?n:null,g?k.children(":selected").text():null,g?l.children(":selected").text():null,g?m.children(":selected").text():null,0==regTypeCode?$("#CPA").val():regTypeCode,null,null,null,null,null,null,null);var o={idNo:$(".idDetails").val(),phone1:$(".area_codeDetails").val()+$(".phoneDetails").val(),phone2:$("#area_code_ext").val()+$("#phone_ext").val(),email:$.trim($(".emailDetails").val()),customerName:$(".firstnameDetails").val()+" "+$(".lastnameDetails").val(),regTypeCode:0==regTypeCode?$("#CPA").val():regTypeCode};$.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/UpdateAuthentucation",data:JSON.stringify(o),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){},error:function(a,b,c){}})}return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}},ARKIA.WIZARD.COMPANIONS={reLoad:!0,temAcomp:null,accompaniedCtrl:["$scope",function(a){for(var b=new Array,c=new Array,d=new Array,e=(new Date).getFullYear(),f=0,g=e;g>e-100;g--)b[f]=g,f++;for(var g=1;g<13;g++)c[g-1]=g;for(var g=1;g<32;g++)d[g-1]=g;a.cmdtitles=[],$.each(titlesData,function(b,c){a.cmdtitles.push({cmdtitle:c.Name,value:c.Id})}),a.cmdjobtitles=[],$.each(jobTitlesData,function(b,c){a.cmdjobtitles.push({cmdjobtitle:c.Name,value:c.Id})}),a.cmdyears=b,a.cmdmonths=c,a.cmddays=d;for(var b=new Array,c=new Array,d=new Array,e=(new Date).getFullYear(),f=0,g=e-5;g<e+10;g++)b[f]=g,f++;for(var g=1;g<13;g++)c[g-1]=g;for(var g=1;g<32;g++)d[g-1]=g;a.cmdtitles=[],$.each(titlesData,function(b,c){a.cmdtitles.push({cmdtitle:c.Name,value:c.Id})}),a.cmdjobtitles=[],$.each(jobTitlesData,function(b,c){a.cmdjobtitles.push({cmdjobtitle:c.Name,value:c.Id})}),a.cmdPyears=b,a.cmdPmonths=c,a.cmdPdays=d,a.items=[];var h;a.init=function(){if(ARKIA.WIZARD.COMPANIONS.reLoad){if(h=ARKIA2.WIZARD.getReservation(),null==h.COMPANIONS)a.items=[],a.items.push({});else{for(var b=h.COMPANIONS.Value,c=0;c<b.length;c++)b[c].YEAR=parseInt(b[c].DOB.substring(0,4)),b[c].MONTH=parseInt(b[c].DOB.substring(4,6)),b[c].DAY=parseInt(b[c].DOB.substring(6,8)),b[c].PASSPORT_YEAR=new Date(b[c].EXPIRE_DATE).getFullYear(),b[c].PASSPORT_MONTH=new Date(b[c].EXPIRE_DATE).getUTCMonth()+1,b[c].PASSPORT_DAY=new Date(b[c].EXPIRE_DATE).getUTCDate()+1,1==b[c].TITLE_CODE?b[c].TITLE_CODE_select=a.cmdtitles[0]:b[c].TITLE_CODE_select=a.cmdtitles[1],0!=b[c].JOB_TITLE_CODE&&(b[c].JOB_TITLE_CODE_select=a.cmdjobtitles[b[c].JOB_TITLE_CODE-1]);a.items=b}setTimeout(function(){$("[role='LATIN_LAST_NAME_ACM']").each(function(){$(this).keyfilter(/[a-zA-Z\ ]/i)}),$("[role='LATIN_FIRST_NAME_ACM']").each(function(){$(this).keyfilter(/[a-zA-Z\ ]/i)}),$("[role='PASSPORT_ACM']").each(function(){$(this).keyfilter(/[0-9]/i)}),$("[role='YEAR_ACM']").each(function(){$(this).attr("aria-label",MSG427)}),$("[role='MONTH_ACM']").each(function(){$(this).attr("aria-label",MSG428)}),$("[role='DAY_ACM']").each(function(){$(this).attr("aria-label",MSG429)}),$("[role='PASSPORT_YEAR_ACM']").each(function(){$(this).attr("aria-label",MSG430)}),$("[role='PASSPORT_MONTH_ACM']").each(function(){$(this).attr("aria-label",MSG431)}),$("[role='PASSPORT_DAY_ACM']").each(function(){$(this).attr("aria-label",MSG432)}),$("[role='accompDelete']").each(function(a){$(this).attr("aria-label",MSG433.replace("{0}",a+1))}),$("[role='TITLE_CODE_ACM']").attr("aria-label",MSG443),$("[role='JOB_TITLE_CODE_ACM']").attr("aria-label",MSG444),$(".bodyMain.ltr").length?($("[role='PASSPORT_ACM']").attr("placeholder","passport number"),$("[role='LATIN_LAST_NAME_ACM'], [role='LATIN_FIRST_NAME_ACM']").each(function(){$(this).attr("title","in english")})):($("[role='PASSPORT_ACM']").attr("placeholder","מספר דרכון"),$("[role='LATIN_LAST_NAME_ACM'], [role='LATIN_FIRST_NAME_ACM']").each(function(){$(this).attr("title","באנגלית")}))},100),ARKIA.WIZARD.COMPANIONS.reLoad=!1}ARKIA.WIZARD.COMPANIONS.temAcomp=a.items},a.addItem=function(){a.items.length<MaxCompanions&&(a.items.push({}),setTimeout(function(){$(".accompaniedRow:last select:first").focus()},100),a.items.length==MaxCompanions&&($(".accompaniedAddLink").attr("aria-disabled","true"),$(".accompaniedAddLink").attr("tabindex","-1"))),a.reset(),setTimeout(function(){$("[role='LATIN_LAST_NAME_ACM']").each(function(){$(this).keyfilter(/[a-zA-Z\ ]/i)}),$("[role='LATIN_FIRST_NAME_ACM']").each(function(){$(this).keyfilter(/[a-zA-Z\ ]/i)}),$("[role='PASSPORT_ACM']").each(function(){$(this).keyfilter(/[0-9]/i)}),$("[role='YEAR_ACM']").each(function(){$(this).attr("aria-label",MSG427)}),$("[role='MONTH_ACM']").each(function(){$(this).attr("aria-label",MSG428)}),$("[role='DAY_ACM']").each(function(){$(this).attr("aria-label",MSG429)}),$("[role='PASSPORT_YEAR_ACM']").each(function(){$(this).attr("aria-label",MSG430)}),$("[role='PASSPORT_MONTH_ACM']").each(function(){$(this).attr("aria-label",MSG431)}),$("[role='PASSPORT_DAY_ACM']").each(function(){$(this).attr("aria-label",MSG432)}),$("[role='accompDelete']").each(function(a){$(this).attr("aria-label",MSG433.replace("{0}",a+1))}),$("[role='TITLE_CODE_ACM']").attr("aria-label",MSG443),$("[role='JOB_TITLE_CODE_ACM']").attr("aria-label",MSG444),$(".bodyMain.ltr").length?($("[role='PASSPORT_ACM']").attr("placeholder","passport number"),$("[role='LATIN_LAST_NAME_ACM'], [role='LATIN_FIRST_NAME_ACM']").attr("title","in english")):($("[role='PASSPORT_ACM']").attr("placeholder","מספר דרכון"),$("[role='LATIN_LAST_NAME_ACM'], [role='LATIN_FIRST_NAME_ACM']").attr("title","באנגלית"))},100)},a.delete_item=function(b){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;if(b=0,arguments.length>1&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&b!=1/0&&b!=-1/0&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),b>=e)return-1;for(c=b>=0?b:Math.max(e-Math.abs(b),0);c<e;c++)if(c in d&&d[c]===a)return c;return-1});var c=a.items.indexOf(b);a.items.length>1?(a.items.splice(c,1),setTimeout(function(){c<a.items.length?$("[role='TITLE_CODE_ACM']").eq(c).focus():$("[role='TITLE_CODE_ACM']:last").focus()},2e3)):1===a.items.length&&(a.items[0]={},setTimeout(function(){$("[role='TITLE_CODE_ACM']:first").focus()},100)),a.items.length<MaxCompanions&&($(".accompaniedAddLink").attr("aria-disabled","false"),$(".accompaniedAddLink").attr("tabindex","0")),a.reset()},a.reset=function(){ARKIA2.WIZARD.resetCompanions(!0),ARKIA.WIZARD.FEES.reLoad=ARKIA.WIZARD.FLIGHTS.reLoad=ARKIA.WIZARD.HOTELS.reLoad=ARKIA.WIZARD.HOTELS.reLoad2=ARKIA.WIZARD.PRODUCTS.PRD05.reLoad=ARKIA.WIZARD.PRODUCTS.PRD06.reLoad=ARKIA.WIZARD.PRODUCTS.PRD07.reLoad=ARKIA.WIZARD.MEALS.PRD13.reLoad=ARKIA.WIZARD.COMPANIONS.reLoad=ARKIA.WIZARD.SHUTTLE.reLoad=!0}}],ValidateStep:function(a){var b=!0,c="",d=new Array,e=!1,f=ARKIA2.WIZARD.getReservation();if(""!==$.trim($("[role='LATIN_LAST_NAME_ACM']").val())||$("[role='TITLE_CODE_ACM']").val()>="0"||""!==$.trim($("[role='LATIN_FIRST_NAME_ACM']").val())||$("[role='YEAR_ACM']").val()>="0"||$("[role='MONTH_ACM']").val()>="0"||$("[role='DAY_ACM']").val()>="0"||ARKIA.WIZARD.COMPANIONS.temAcomp.length>1){$("[role='TITLE_CODE_ACM']").each(function(a,c){$(this).val()<"0"&&(b=!1,$(this).addClass("inputError"),d[d.length]=MSG50.replace("{0}",a+1))});var g=/[a-zA-Z\ ]/i;$("[role='LATIN_FIRST_NAME_ACM']").each(function(a,c){$.trim($(this).val()).length>0&&(g.test($.trim($(this).val()))||(b=!1,$(this).addClass("inputError"),d[d.length]=MSG392.replace("{0}",a+1)))}),$("[role='LATIN_LAST_NAME_ACM']").each(function(a,c){$.trim($(this).val()).length>0&&(g.test($.trim($(this).val()))||(b=!1,$(this).addClass("inputError"),d[d.length]=MSG393.replace("{0}",a+1)))}),$("[role='LATIN_LAST_NAME_ACM']").each(function(a,c){$.trim($(this).val()).length<2&&(b=!1,$(this).addClass("inputError"),d[d.length]=MSG51.replace("{0}",a+1))}),$("[role='LATIN_FIRST_NAME_ACM']").each(function(a,c){$.trim($(this).val()).length<2&&(b=!1,$(this).addClass("inputError"),d[d.length]=MSG52.replace("{0}",a+1))});for(var h=f.CUSTOMER.PASSPORT_NO,i=0;i<$(".accompaniedRow [role='PASSPORT_ACM']").length;i++)$.trim($(".accompaniedRow [role='PASSPORT_ACM']").eq(i).val())==h&&(b=!1,$(".accompaniedRow [role='PASSPORT_ACM']").eq(i).addClass("inputError"),d[d.length]=MSG425.replace("{0}",i+1));var j=1,k=0,l=0;$("[role='YEAR_ACM']").each(function(a,c){var e=$(this).parent(),f=$("[role='YEAR_ACM']",e),g=$("[role='MONTH_ACM']",e),h=$("[role='DAY_ACM']",e);if(f.val()<"0"||g.val()<"0"||h.val()<"0")b=!1,f.val()<"0"&&f.addClass("inputError"),g.val()<"0"&&g.addClass("inputError"),h.val()<"0"&&h.addClass("inputError"),d[d.length]=MSG53.replace("{0}",a+1);else{(ARKIA.COMMON.isNotLogicalDate(h.children(":selected").text(),g.children(":selected").text())||ARKIA.COMMON.isFutureDate(h.children(":selected").text(),g.children(":selected").text(),f.children(":selected").text()))&&(b=!1,h.addClass("inputError"),g.addClass("inputError"),d[d.length]=MSG54.replace("{0}",a+1)),h.children(":selected").text()>=29&&2==g.children(":selected").text()&&ARKIA.COMMON.isNotLogicalFeb29(h.children(":selected").text(),f.children(":selected").text())&&(b=!1,h.addClass("inputError"),g.addClass("inputError"),d[d.length]=MSG54.replace("{0}",a+1));var i=startDate.split("/"),m=new Date(i[2],i[1]-1,i[0]),n=f.children(":selected").text(),o=g.children(":selected").text(),p=h.children(":selected").text(),q=new Date(n,o-1,p),r=m.getFullYear()-q.getFullYear(),s=m.getMonth()-q.getMonth();(s<0||0===s&&m.getDate()<q.getDate())&&r--;var t=$("[role='AGE_GROUP']",e);(r>ChildAgeEnd&&"ילד"==t.val()||r>ChildAgeStart&&"תינוק"==t.val()||r<ChildAgeEnd&&"מבוגר"==t.val())&&(b=!1,$(this).addClass("inputError"),d[d.length]=MSG338.replace("{0}",a+1)),r<ChildAgeStart?l++:r<ChildAgeEnd?k++:j++,l>2&&(b=!1,$("[role='YEAR_ACM']").addClass("inputError"),d[d.length]=MSG422)}}),hasPassport&&($("[role='PASSPORT_ACM']").each(function(a,c){$.trim($(this).val()).length<6&&(b=!1,$(this).addClass("inputError"),d[d.length]=MSG318.replace("{0}",a+1))}),$("[role='PASSPORT_YEAR_ACM']").each(function(a,e){var f=$(this).parent(),g=$("[role='PASSPORT_YEAR_ACM']",f),h=$("[role='PASSPORT_MONTH_ACM']",f),i=$("[role='PASSPORT_DAY_ACM']",f);g.val()<"0"||h.val()<"0"||i.val()<"0"?(b=!1,g.val()<"0"&&g.addClass("inputError"),h.val()<"0"&&h.addClass("inputError"),i.val()<"0"&&i.addClass("inputError"),d[d.length]=MSG319.replace("{0}",a+1)):(ARKIA.COMMON.isNotLogicalDate(i.children(":selected").text(),h.children(":selected").text())&&(b=!1,i.addClass("inputError"),h.addClass("inputError"),d[d.length]=MSG319.replace("{0}",a+1)),i.children(":selected").text()>=29&&2==h.children(":selected").text()?ARKIA.COMMON.isNotLogicalFeb29(i.children(":selected").text(),g.children(":selected").text())&&(b=!1,i.addClass("inputError"),h.addClass("inputError"),d[d.length]=MSG319.replace("{0}",a+1)):ARKIA.COMMON.isFutureDate6Month(i.children(":selected").text(),h.children(":selected").text(),g.children(":selected").text())||(c+=MSG337.replace("{0}",a+1),c+="\n"))}))}else e=!0;if(b&&(""!=c&&alert(c),ARKIA2.WIZARD.resetCompanions(),!e))for(var i=0;i<ARKIA.WIZARD.COMPANIONS.temAcomp.length;i++){var m="";hasPassport&&(m=new Date(ARKIA.WIZARD.COMPANIONS.temAcomp[i].PASSPORT_YEAR,parseInt(ARKIA.WIZARD.COMPANIONS.temAcomp[i].PASSPORT_MONTH)-1,ARKIA.WIZARD.COMPANIONS.temAcomp[i].PASSPORT_DAY)),ARKIA2.WIZARD.addCompanions(ARKIA.WIZARD.COMPANIONS.temAcomp[i].TITLE_CODE_select.value,null!=ARKIA.WIZARD.COMPANIONS.temAcomp[i].JOB_TITLE_CODE_select?ARKIA.WIZARD.COMPANIONS.temAcomp[i].JOB_TITLE_CODE_select.value:0,ARKIA.WIZARD.COMPANIONS.temAcomp[i].LATIN_LAST_NAME,ARKIA.WIZARD.COMPANIONS.temAcomp[i].LATIN_FIRST_NAME,ARKIA.WIZARD.COMPANIONS.temAcomp[i].YEAR,ARKIA.WIZARD.COMPANIONS.temAcomp[i].MONTH,ARKIA.WIZARD.COMPANIONS.temAcomp[i].DAY,1==hasPassport?ARKIA.WIZARD.COMPANIONS.temAcomp[i].PASSPORT_NO:null,1==hasPassport?m:null)}return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(d)),b}},ARKIA.WIZARD.FEES={temfees:null,reLoad:!0,registrFeeCtrl:["$scope",function(a){a.totalPrice="",a.init=function(){var b=ARKIA2.WIZARD.getReservation();if(null==b.FEES&&!a.items||ARKIA.WIZARD.FEES.reLoad){$.ajax({type:"POST",async:!1,url:"webmethods/AjaxMethods.aspx/GetFees",contentType:"application/json; charset=utf-8",dataType:"json",success:function(c){ARKIA.WIZARD.FEES.reLoad=!1;var d=c.d;eventsCurrency=d.mainFees[0].CURRENCY;var e={CUSTOMER_NO:b.CUSTOMER.CUSTOMER_NO,AGE_GROUP:"A",LATIN_FIRST_NAME:b.CUSTOMER.LATIN_FIRST_NAME,LATIN_LAST_NAME:b.CUSTOMER.LATIN_LAST_NAME,FEES:d.mainFees,ALL_FEES:d.mainFees,SELECTED_PRD_KEY:d.mainFees.length>1?"":d.mainFees[0].AP_PRD_KEY,SELECTED_FEE:d.mainFees.length>1?null:d.mainFees[0],HOTEL_REQUIRE_YN:d.mainFees.length>1?"":d.mainFees[0].HOTEL_REQUIRE_YN,PRICE:d.mainFees.length>1?0:d.mainFees[0].PRICE,PRICE_CURRENCY:d.mainFees.length>1?"":d.mainFees[0].PRICE_CURRENCY};1==d.mainFees.length&&("N"==d.mainFees[0].HOTEL_REQUIRE_YN?$("#buttonNextFees").attr("jumpStep",!0):$("#buttonNextFees").removeAttr("jumpStep"));ARKIA2.WIZARD.getAgeGroupCountRegType();a.items=[],a.items.push(e),b.COMPANIONS&&$.each(b.COMPANIONS.Value,function(b,c){var f,g=ARKIA2.WIZARD.getAgeGroupRegType(c),h=ARKIA2.WIZARD.getAgeByDate(c.DOB);f=d.companionsFees.filter(function(a){return a.AGE_FROM<=h&&a.AGE_TO>=h}),e={CUSTOMER_NO:c.CUSTOMER_NO,AGE_GROUP:g,LATIN_FIRST_NAME:c.LATIN_FIRST_NAME,LATIN_LAST_NAME:c.LATIN_LAST_NAME,FEES:f,ALL_FEES:f,SELECTED_PRD_KEY:f.length>1?"":f[0].AP_PRD_KEY,SELECTED_FEE:f.length>1?null:f[0],HOTEL_REQUIRE_YN:f.length>1?"":f[0].HOTEL_REQUIRE_YN,PRICE:f.length>1?0:f[0].PRICE,PRICE_CURRENCY:f.length>1?"":f[0].PRICE_CURRENCY},a.items.push(e)})},error:function(a,b,c){window.location=errorPage}});var c=0;$.each(a.items,function(a,b){c+=b.PRICE}),a.totalPrice=c>0?eventsCurrency+c.formatMoney(0,".",","):"",ARKIA.WIZARD.FEES.temfees=a.items}},a.feesChange=function(b,c){var d=jQuery.grep(b.FEES,function(a){return a.AP_PRD_KEY==b.SELECTED_PRD_KEY});0==d.length?(b.SELECTED_FEE=null,b.PRICE=0,b.PRICE_CURRENCY="",b.HOTEL_REQUIRE_YN=""):(b.SELECTED_FEE=d[0],b.PRICE=d[0].PRICE,b.PRICE_CURRENCY=d[0].PRICE_CURRENCY,b.HOTEL_REQUIRE_YN=d[0].HOTEL_REQUIRE_YN),1==b.CUSTOMER_NO&&($.each(a.items,function(a,b){b.ALL_FEES&&b.ALL_FEES.length>1&&b.CUSTOMER_NO>1&&(b.FEES=jQuery.grep(b.ALL_FEES,function(a){return 0==d.length||!a.HOTEL_REQUIRE_YN||""==a.HOTEL_REQUIRE_YN||a.HOTEL_REQUIRE_YN==d[0].HOTEL_REQUIRE_YN}),1==b.FEES.length?(b.SELECTED_PRD_KEY=b.FEES[0].AP_PRD_KEY,b.SELECTED_FEE=b.FEES[0],b.PRICE=b.FEES[0].PRICE,b.PRICE_CURRENCY=b.FEES[0].PRICE_CURRENCY,b.HOTEL_REQUIRE_YN=b.FEES[0].HOTEL_REQUIRE_YN):(b.SELECTED_PRD_KEY="",b.SELECTED_FEE=null,b.PRICE=0,b.PRICE_CURRENCY="",b.HOTEL_REQUIRE_YN=""))}),d.length>0&&"N"==d[0].HOTEL_REQUIRE_YN?$("#buttonNextFees").attr("jumpStep",!0):$("#buttonNextFees").removeAttr("jumpStep"));var e=0;$.each(a.items,function(a,b){e+=b.PRICE}),a.totalPrice=e>0?eventsCurrency+e.formatMoney(0,".",","):"",c&&(ARKIA2.WIZARD.resetHotels(),ARKIA.WIZARD.HOTELS.reLoad=ARKIA.WIZARD.HOTELS.reLoad2=!0,ARKIA.WIZARD.HOTELS.roomsChecked=null)}}],ValidateStep:function(a){var b=!0,c=new Array;if($("[role='FEE_ACM_RGS05']").each(function(a,d){$(this).val()<"0"&&(b=!1,$(this).addClass("inputError"),c[c.length]=MSG55.replace("{0}",a+1))}),b){ARKIA2.WIZARD.resetFees();for(var d in ARKIA.WIZARD.FEES.temfees)ARKIA2.WIZARD.addFee(ARKIA.WIZARD.FEES.temfees[d].SELECTED_PRD_KEY,ARKIA.WIZARD.FEES.temfees[d].CUSTOMER_NO)}return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.HOTELS.init()}),ARKIA.WIZARD.HOTELS={reLoad:!0,reLoad2:!0,roomsChecked:{},partyTypeDefault:null,init:function(){$("#btnHotelCon").click(function(){var a=!1,b=new Array;$(".inputError").removeClass("inputError");var c=4,d=!0;if(""===$("[role='HOTEL_PRD01']").val()&&(d=!1,$("[role='HOTEL_PRD01']").addClass("inputError"),b.push(MSG112)),""===$("[role='ACOM_PRD01']").val()&&(d=!1,$("[role='ACOM_PRD01']").addClass("inputError"),b.push(MSG62)),""===$("[role='ROOM_PRD01']").val()&&(d=!1,$("[role='ROOM_PRD01']").addClass("inputError"),b.push(MSG63)),$("[role='ROOM_NUM']").exists()){a=!0;var e=0,f=0,g=0;$("[role='ROOM_NUM']").each(function(c,h){var i=$(this).parent();window.innerWidth<768&&(i=$(this).parent().parent()),""===$("[role='ROOM_TYPE_NAME']",i).val()&&(d=!1,$("[role='ROOM_TYPE_NAME']",i).addClass("inputError"),b.push(MSG64.replace("{0}",c+1)),a=!1),$("[role='PARTY_TYPE_NAME']",i).val()<"0"&&(d=!1,$("[role='PARTY_TYPE_NAME']",i).addClass("inputError"),b.push(MSG65.replace("{0}",c+1)),a=!1),a&&void 0!==ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[c].PARTY_TYPE&&(e+=Number(ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[c].PARTY_TYPE.ADULTS),f+=Number(ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[c].PARTY_TYPE.CHILDREN),g+=Number(ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[c].INFANTS))})}if(a){var h=ARKIA2.WIZARD.getAgeGroupCount();h.adults==e&&h.children==f||($("[role='ROOM_NUM']").each(function(a,b){$("[role='PARTY_TYPE_NAME']").addClass("inputError"),d=!1}),b.push(MSG68)),h.infants!=g&&$("[role='ROOM_NUM']").each(function(a,c){$("[role='MAX_INFANTS']").addClass("inputError"),d=!1,b.push(MSG67.replace("{0}",a+1))});var i=[];$(ARKIA.WIZARD.HOTELS.roomsChecked.hotel.ROOMS.Value).each(function(a,b){i.push({type:ARKIA.WIZARD.HOTELS.roomsChecked.hotel.ROOMS.Value[a].ROOM_TYPE_NAME,limit:ARKIA.WIZARD.HOTELS.roomsChecked.hotel.ROOMS.Value[a].ROOMS_NO,roomsNum:0})});for(var j=0;j<ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms.length;j++)for(var k=0;k<i.length;k++)if(i[k].type===ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[j].ROOM.ROOM_TYPE_NAME){i[k].roomsNum++;break}for(var j in i)if(i[j].limit<i[j].roomsNum){d=!1,b.push(MSG66);break}}d?(ARKIA2.WIZARD.resetHotels(),ARKIA2.WIZARD.setHotelComment($("#HotelComment").val()),$("#PRD01").hide(),$("#PRD02").show(),angular.element(document.getElementById("ng_Ctrl_PRD02")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD02")).scope().$apply(),$(".roomPrice").css("margin-top",($(".hotelInfoRow").height()-24)/2),$(".marketingTextBox").height($(".hotelsRowThird").height()-20)):errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b),ARKIA.WIZARD.setError(c,!d)}),$("#backToPRD01").click(function(){$(".inputError").removeClass("inputError"),$(".msgBox").css("display","none"),$("#PRD01").show(),$("#PRD02").hide()}),$("#HotelComment").keyfilter(/[א-ת0-9_\.\-\,\:\;\!\ ]/i),$(".bodyMain.ltr").length?$("#HotelComment").attr("title","In Hebrew"):$("#HotelComment").attr("title","הזן בעברית")},hotesCtrl:["$scope","$http",function(a,b){a.hotels=[],a.noInfants=!1,a.hotelOptions={},a.hotelOptions.hotel={},a.hotelOptions.room={},a.hotelOptions.board={},a.rooms_amount_arr=[],a.hotelOptions.rooms_amount,a.hotelOptions.selectedRooms=[],a.INFANTS_ARR_proto=[0,1,2,3,4,5],$("#HotelComment").keyfilter(/[א-ת0-9_\.\-\,\:\;\!\ ]/i);for(var c=[],d=0;d<maxRooms;d++)c.push(d+1);a.changeHotels=function(b){ARKIA.WIZARD.HOTELS.reLoad2=!0,ARKIA.WIZARD.HOTELS.partyTypeDefault=null,null==b.hotel?(b.boards={},a.rooms_amount_arr=[],b.rooms_amount=null,b.selectedRooms=[]):1==b.hotel.BOARD_BASIS.Value.length?(b.boards=b.hotel.BOARD_BASIS.Value[0],a.changeBoardBasis(b.boards)):b.boards={}},a.changeBoardBasis=function(b){var d=ARKIA2.WIZARD.getAgeGroupCount();ARKIA.WIZARD.HOTELS.reLoad2=!0,ARKIA.WIZARD.HOTELS.partyTypeDefault=null,null==b?(a.rooms_amount_arr=[],a.hotelOptions.rooms_amount=null,a.hotelOptions.selectedRooms=[]):(a.rooms_amount_arr=[],a.hotelOptions.rooms_amount=null,a.hotelOptions.selectedRooms=[],null!=a.hotelOptions.hotel&&(a.rooms_amount_arr=c,1===c.length||1===d.adults&&0===d.children?(a.hotelOptions.rooms_amount=c[0],a.changeRooms(a.hotelOptions),a.adultsCount=1):(a.hotelOptions.rooms_amount=0,a.adultsCount=0))),angular.forEach($("select:visible"),function(a){a.options[a.selectedIndex].text+=" "})},a.changeRooms=function(b){ARKIA.WIZARD.HOTELS.reLoad2=!0,ARKIA.WIZARD.HOTELS.partyTypeDefault=null,a.hotelOptions.selectedRooms=[];for(var c=0;c<b.rooms_amount;c++)a.hotelOptions.selectedRooms.push({});if(angular.forEach($("select:visible"),function(a){a.options[a.selectedIndex].text+=" "}),ARKIA.WIZARD.HOTELS.roomsChecked=b,null!=ARKIA.WIZARD.HOTELS.partyTypeDefault&&(b.selectedRooms[0].PARTY_TYPE=b.selectedRooms[0].ROOM.PARTY_TYPES.Value[ARKIA.WIZARD.HOTELS.partyTypeDefault]),1==b.hotel.ROOMS.Value.length)for(var c=0;c<a.hotelOptions.selectedRooms.length;c++)a.hotelOptions.selectedRooms[c].ROOM=a.hotelOptions.hotel.ROOMS.Value[0],a.roomTypeChanged(a.hotelOptions.selectedRooms[c])},a.roomTypeChanged=function(b){if(null!=b.ROOM){b.INFANTS_ARR=a.INFANTS_ARR_proto.slice(0,b.ROOM.MAX_INFANTS+1),b.INFANTS=b.INFANTS_ARR[0];var c=ARKIA2.WIZARD.getAgeGroupCount();if(1==a.hotelOptions.selectedRooms.length)for(var d=a.hotelOptions.hotel.ROOMS.Value[0].PARTY_TYPES.Value.length,e=0;e<d;e++)if(a.hotelOptions.hotel.ROOMS.Value[0].PARTY_TYPES.Value[e].ADULTS==c.adults&&a.hotelOptions.hotel.ROOMS.Value[0].PARTY_TYPES.Value[e].CHILDREN==c.children){ARKIA.WIZARD.HOTELS.partyTypeDefault=e;break}if(1==a.hotelOptions.rooms_amount&&b.ROOM.PARTY_TYPES.Value.length>1){var f=jQuery.grep(b.ROOM.PARTY_TYPES.Value,function(a){return a.ADULTS==c.adults&&a.CHILDREN==c.children});b.PARTY_TYPE=f[0],a.updatePrice(b)}1==b.ROOM.PARTY_TYPES.Value.length&&(b.PARTY_TYPE=b.ROOM.PARTY_TYPES.Value[0],a.updatePrice(b)),1==a.hotelOptions.rooms_amount&&(b.INFANTS=c.infants,a.updatePrice(b)),a.noInfants&&$(".roomInfantsSel").css("display","none")}ARKIA.WIZARD.HOTELS.reLoad2=!0},a.updatePrice=function(b){if(ARKIA.WIZARD.HOTELS.reLoad2=!0,ARKIA.WIZARD.HOTELS.partyTypeDefault=null,angular.forEach($("select:visible"),function(a){a.options[a.selectedIndex].text+=" "}),b.PRICE_FORMATTED="",null!=b.PARTY_TYPE){var c=jQuery.grep(b.PARTY_TYPE.PRICES.Value,function(b){return b.BOARD_BASIS_CODE==a.hotelOptions.boards.CODE}),d=c[0].INFANT_PRICE*b.INFANTS;b.PRICE_FORMATTED=eventsCurrency+(c[0].PRICE+d).formatMoney(0,".",",")}},a.init=function(){if(a.noInfants=0===ARKIA2.WIZARD.getAgeGroupCount().infants,!a.hotels||ARKIA.WIZARD.HOTELS.reLoad){$("[role='adultsCount']").empty(),$("[role='childrencCount']").empty(),$("[role='infantsCount']").empty(),$("[role='childLine']").hide(),$("[role='infantLine']").hide(),$('[role="HOTEL_COMMENT"]').val("");var c=ARKIA2.WIZARD.getAgeGroupCount();1===c.adults?$(".bodyMain.ltr").length?$("[role='adultsCount']").text("adult"):$("[role='adultsCount']").text("מבוגר"):$(".bodyMain.ltr").length?$("[role='adultsCount']").text(c.adults+" adults"):$("[role='adultsCount']").text(c.adults+" מבוגרים"),c.children>0&&($("[role='childLine']").show(),1===c.children?$(".bodyMain.ltr").length?$("[role='childrencCount']").text("child"):$("[role='childrencCount']").text("ילד"):$(".bodyMain.ltr").length?$("[role='childrencCount']").text(c.children+" children"):$("[role='childrencCount']").text(c.children+" ילדים")),c.infants>0&&($("[role='infantLine']").show(),1===c.infants?$(".bodyMain.ltr").length?$("[role='infantsCount']").text("infant"):$("[role='infantsCount']").text("תינוק"):$(".bodyMain.ltr").length?$("[role='infantsCount']").text(c.infants+" infants"):$("[role='infantsCount']").text(c.infants+" תינוקות")),a.hotelOptions.rooms_amount=0,a.hotelOptions.selectedRooms=null,a.hotelOptions.hotel=null;var d=ARKIA2.WIZARD.getAgeGroupCount();b({url:"webmethods/AjaxMethods.aspx/GetHotels",method:"POST",data:JSON.stringify(d),headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,c,d,e){null==b.d.Value&&(alert(MSG383),window.location="./event-cycles"),a.hotels=b.d.Value,1==a.hotels.length&&(a.hotelOptions.hotel=a.hotels[0],a.changeHotels(a.hotelOptions)),ARKIA.WIZARD.HOTELS.reLoad=!1,$("#hotelsLoader").hide(),$("#hotelsContent").show()}).error(function(a,b,c,d){window.location=errorPage})}}}],hotesCtrl_2:["$scope","$http",function(a,b){if(a.checkedOptions={},$(".bodyMain.ltr").length)var c=["adult","child","infant"];else var c=["מבוגר","ילד","תינוק"];var d=0;a.addAllHotelRooms=function(){for(var b in a.checkedOptions.selectedRooms){var c,d,e;c=a.checkedOptions.selectedRooms[b].ROOM.ROOM_PRD_KEY,d=a.checkedOptions.selectedRooms[b].PARTY_TYPE.PARTY_TYPE_CODE,e=a.checkedOptions.boards.CODE;var f=[];for(var g in a.checkedOptions.selectedRooms[b].room_customers)f.push(a.checkedOptions.selectedRooms[b].room_customers[g].room_customer.CUSTOMER_NO);ARKIA2.WIZARD.addHotelRoom(c,d,e,f)}},a.init_flag=!0,a.init=function(){if(1==ARKIA.WIZARD.HOTELS.reLoad2){a.init_flag=!0;var b={A:[],C:[],I:[]};$('[role="HOTEL_COMMENT"]').val(""),a.checkedOptions=ARKIA.WIZARD.HOTELS.roomsChecked;var e=ARKIA2.WIZARD.getPassengers();for(var f in e)e[f].fullName=e[f].LATIN_FIRST_NAME+" "+e[f].LATIN_LAST_NAME,b[e[f].AgeGroup].push(e[f]),d+="I"==e[f].AgeGroup?1:0;for(var g in a.checkedOptions.selectedRooms){var h=a.checkedOptions.selectedRooms[g].PARTY_TYPE.ADULTS,i=a.checkedOptions.selectedRooms[g].PARTY_TYPE.CHILDREN,j=a.checkedOptions.selectedRooms[g].INFANTS;a.checkedOptions.selectedRooms[g].room_customers=[];for(var k=0;k<a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value.length;k++)if(a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value[k].BOARD_BASIS_CODE==ARKIA.WIZARD.HOTELS.roomsChecked.boards.CODE){var l=a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value[k].INFANT_PRICE*j;a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICE_FORMATTED=a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value[k].PRICE>0?eventsCurrency+(a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value[k].PRICE+l).formatMoney(0,".",","):"",a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICE_SELECTED=a.checkedOptions.selectedRooms[g].PARTY_TYPE.PRICES.Value[k].PRICE+l;break}var m=1==a.checkedOptions.selectedRooms.length,n=[];for(var o in b.A)n.push(b.A[o]);for(var p=0;p<h;p++)a.checkedOptions.selectedRooms[g].room_customers.push({room_customer:m?n[p]:null,type:"A",select_arr:m?[n[p]]:n,label:c[0]});var n=[];for(var o in b.C)n.push(b.C[o]);for(var p=0;p<i;p++)a.checkedOptions.selectedRooms[g].room_customers.push({room_customer:m?n[p]:null,type:"C",select_arr:m?[n[p]]:n,label:c[1]});var n=[];for(var o in b.I)n.push(b.I[o]);for(var p=0;p<j;p++)a.checkedOptions.selectedRooms[g].room_customers.push({room_customer:m?n[p]:null,type:"I",select_arr:m?[n[p]]:n,label:c[2]})}ARKIA.WIZARD.HOTELS.reLoad2=!1,setTimeout(function(){$(".hotelInfoRow .roomTypeSel").each(function(){$(this).attr("aria-label",$(this).parents(".roomsResultRow").find(".roomNumLbl").text()+" "+$(this).prev().text())})},100)}1==a.checkedOptions.selectedRooms.length&&$("#buttonNextHotel").click()},a.clearSelected=function(b){ARKIA.WIZARD.HOTELS.reLoad2=!0,a.init()},a.passengersChange=function(a,b,c){if(null!=b.OLD_SELECTED&&$.each(c,function(a,c){$.each(c.room_customers,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.type==b.type&&c.select_arr.push(b.OLD_SELECTED)})}),null!=b.room_customer&&$.each(c,function(a,c){$.each(c.room_customers,function(a,c){c.room_customer!=b.room_customer&&(c.select_arr=jQuery.grep(c.select_arr,function(a){return a.CUSTOMER_NO!=b.room_customer.CUSTOMER_NO}))})}),angular.forEach($("select:visible"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.room_customer){var d=jQuery.grep(b.select_arr,function(a){return a.CUSTOMER_NO==b.room_customer.CUSTOMER_NO});b.OLD_SELECTED=d[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=!0,c=new Array;return $("[role='CUSTOMER_PRD02']").each(function(a,d){$(this).val()<"0"&&(b=!1,$(this).addClass("inputError"),c.push(MSG74.replace("{0}",a+1)))}),b&&angular.element(document.getElementById("ng_Ctrl_PRD02")).scope().addAllHotelRooms(),b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.FLIGHTS.init()}),ARKIA.WIZARD.FLIGHTS={init:function(){(window.location.href.indexOf("dev")>-1||window.location.href.indexOf("192.168.84.25")>-1)&&$("#cbFlightProcFileName").prop("checked",!0),$(".inputError").removeClass("inputError"),$("#btnFlightsCon").click(function(){var a=new Array;$(".inputError").removeClass("inputError");var b=5,c=!0,d=0,e=0;$.each(ARKIA.WIZARD.FLIGHTS.temflights.itemsOB,function(a,b){$.each(b.FLIGHTS.Value,function(a,b){b.selectPassNo&&(d+=b.selectPassNo)})}),$.each(ARKIA.WIZARD.FLIGHTS.temflights.itemsIB,function(a,b){$.each(b.FLIGHTS.Value,function(a,b){b.selectPassNo&&(e+=b.selectPassNo)})});var f=ARKIA2.WIZARD.getAgeGroupCount(),g=f.adults+f.children+f.infants;(d>g||e>g)&&(c=!1,a[a.length]=MSG321),d+e>0?$(".cbflights input[type='checkbox']").is(":checked")||(c=!1,$(".cbflights").addClass("inputError"),a[a.length]=MSG61):(c=!1,a[a.length]=MSG137),c?(ARKIA2.WIZARD.resetFlights(),d+e>0&&ARKIA2.WIZARD.initFlights(),$("#PRD03").hide(),$("#PRD04").show(),angular.element(document.getElementById("ng_Ctrl_PRD04")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD04")).scope().$apply()):errorValues[b]=ARKIA.WIZARD.createErrorListWizard(a),ARKIA.WIZARD.setError(b,!c),window.scrollTo(0,170)})},reLoad:!0,temflights:null,FlightsCtrl:["$scope","$http",function(a,b){a.init=function(){if(!a.itemsOB||ARKIA.WIZARD.FLIGHTS.reLoad){var c=ARKIA2.WIZARD.getReservation();if(null==c.FLIGHTS){b({url:"webmethods/AjaxMethods.aspx/GetFlights",method:"POST",data:null,headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,c,d,e){ARKIA.WIZARD.FLIGHTS.reLoad=!1;var f=b.d;a.itemsOB=f.OBFlights.Value,a.itemsIB=f.IBFlights.Value,ARKIA.WIZARD.FLIGHTS.temflights={itemsOB:a.itemsOB,itemsIB:a.itemsIB},$("#flightsLoader").hide(),$("#flightsContent").show()}).error(function(a,b,c,d){window.location=errorPage});var d=[];d.push(1),null!=c.COMPANIONS&&$.each(c.COMPANIONS.Value,function(a,b){d.push(a+2)}),a.passengers=d,ARKIA.WIZARD.FLIGHTS.temPassflights=null}}},a.passengersCountChange=function(){ARKIA.WIZARD.FLIGHTS.temPassflights=null},a.clearSelectedAndJamp=function(){var a=!1;if($("[role='PASSENGERS_OB_FLIGHT_PRD03']").each(function(b,c){""!=$(this).val()&&(a=!0)}),$("[role='PASSENGERS_IB_FLIGHT_PRD03']").each(function(b,c){""!=$(this).val()&&(a=!0)}),a){if(1==confirm(MSG73)){for(var b=0;b<2;b++){var c=0==b?ARKIA.WIZARD.FLIGHTS.temflights.itemsOB:ARKIA.WIZARD.FLIGHTS.temflights.itemsIB;$.each(c,function(a,b){$.each(b.FLIGHTS.Value,function(a,b){b.selectPassNo=0})})}ARKIA2.WIZARD.resetFlights(),ARKIA.WIZARD.FLIGHTS.temPassflights=null,$("#buttonNextPRD03").click()}}else ARKIA2.WIZARD.resetFlights(),ARKIA.WIZARD.FLIGHTS.temPassflights=null,$("#buttonNextPRD03").click()}}],temPassflights:null,FlightsPassCtrl:["$scope",function(a){a.totalPrice="",a.init=function(){var b=ARKIA2.WIZARD.getPassengers();if(null==ARKIA.WIZARD.FLIGHTS.temPassflights){a.itemsOB=[],a.itemsIB=[],a.itemsOB=a.initFlights(ARKIA.WIZARD.FLIGHTS.temflights.itemsOB,b),a.itemsIB=a.initFlights(ARKIA.WIZARD.FLIGHTS.temflights.itemsIB,b),ARKIA.WIZARD.FLIGHTS.temPassflights={itemsOB:a.itemsOB,itemsIB:a.itemsIB};var c=0;$.each(a.itemsOB,function(a,b){$.each(b.PASSENGERS,function(a,b){c+=b.PRICE})}),$.each(a.itemsIB,function(a,b){$.each(b.PASSENGERS,function(a,b){c+=b.PRICE})}),a.totalPrice=c>0?eventsCurrency+c.formatMoney(0,".",","):""}setTimeout(function(){$("#ng_Ctrl_PRD04 .passItem .selectName").each(function(){$(".bodyMain.ltr").length?$(this).attr("aria-label",$(this).parents(".items").find(".marginRight10").text()+" select passenger"):$(this).attr("aria-label",$(this).parents(".items").find(".marginRight10").text()+" בחר נוסע")})},100);var d=ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB,e=ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB;(0==d.length||1==d.length&&d[0].PASSENGERS.length==b.length)&&(0==e.length||1==e.length&&e[0].PASSENGERS.length==b.length)&&$("#buttonNextFlights").click()},a.initFlights=function(a,b){var c,d=[];for(var e in a){var c=jQuery.grep(a[e].FLIGHTS.Value,function(a){return a.selectPassNo});for(var f in a[e].FLIGHTS.Value){var g=a[e].FLIGHTS.Value[f];if(g.selectPassNo){g.ARR_STATION_NAME=a[e].ARR_STATION_NAME,g.DEP_STATION_NAME=a[e].DEP_STATION_NAME,g.PASSENGERS=[];for(var h=0;h<g.selectPassNo;h++){var i={};1==c.length&&g.selectPassNo==b.length?(i={VALUES:[],SELECT_CUSTOMER_NO:b[h].CUSTOMER_NO,OLD_SELECTED:b[h]},i.VALUES.push(b[h]),"I"==b[h].AgeGroup?(i.PRICE=g.INFANT_PRICE,i.PRICE_CURRENCY=eventsCurrency+g.INFANT_PRICE):"C"==b[h].AgeGroup?(i.PRICE=g.CHILD_PRICE,i.PRICE_CURRENCY=eventsCurrency+g.CHILD_PRICE):(i.PRICE=g.ADULT_PRICE,i.PRICE_CURRENCY=eventsCurrency+g.ADULT_PRICE)):i={VALUES:b,SELECT_CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:0,PRICE_CURRENCY:""},g.PASSENGERS.push(i)}d.push(g)}}}return d},a.passengersChange=function(b,c,d){if(null!=c.OLD_SELECTED&&$.each(d,function(a,b){$.each(b.PASSENGERS,function(a,b){b.OLD_SELECTED!=c.OLD_SELECTED&&b.VALUES.push(c.OLD_SELECTED)})}),null!=c.SELECT_CUSTOMER_NO&&$.each(d,function(a,b){$.each(b.PASSENGERS,function(a,b){b.SELECT_CUSTOMER_NO!=c.SELECT_CUSTOMER_NO&&(b.VALUES=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO!=c.SELECT_CUSTOMER_NO}))})}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=c.SELECT_CUSTOMER_NO){var e=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO==c.SELECT_CUSTOMER_NO});c.OLD_SELECTED=e[0],"I"==e[0].AgeGroup?(c.PRICE=b.INFANT_PRICE,c.PRICE_CURRENCY=eventsCurrency+b.INFANT_PRICE):"C"==e[0].AgeGroup?(c.PRICE=b.CHILD_PRICE,c.PRICE_CURRENCY=eventsCurrency+b.CHILD_PRICE):(c.PRICE=b.ADULT_PRICE,c.PRICE_CURRENCY=eventsCurrency+b.ADULT_PRICE)}else c.OLD_SELECTED=null,c.PRICE=0,c.PRICE_CURRENCY="";var f=0;$.each(a.itemsOB,function(a,b){$.each(b.PASSENGERS,function(a,b){f+=b.PRICE})}),$.each(a.itemsIB,function(a,b){$.each(b.PASSENGERS,function(a,b){f+=b.PRICE})}),a.totalPrice=f>0?eventsCurrency+f.formatMoney(0,".",","):"",setTimeout(function(){$("#PRD04 .TotalPrice.pie").attr("role","alert")},3e3),$("#PRD04 .TotalPrice.pie").removeAttr("role")},a.clearSelected=function(){for(var b=ARKIA2.WIZARD.getPassengers(),c=0;c<2;c++){var d=0==c?a.itemsOB:a.itemsIB;$.each(d,function(a,c){$.each(c.PASSENGERS,function(a,c){c.SELECT_CUSTOMER_NO=0,c.VALUES=b,c.OLD_SELECTED=null,c.PRICE=0,c.PRICE_CURRENCY=""})})}},a.returnToSelectFlights=function(){$(".msgBox").css("display","none"),$("#PRD03").show(),$("#PRD04").hide()}}],ValidateStep:function(a){var b=!0,c=new Array;if(ARKIA.WIZARD.SHUTTLE.reLoad=!0,ARKIA.WIZARD.FLIGHTS.temPassflights)for(var d=0;d<2;d++){var e=0==d?ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB:ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB;$.each(e,function(a,c){$.each(c.PASSENGERS,function(a,c){null!=c.SELECT_CUSTOMER_NO&&0!=c.SELECT_CUSTOMER_NO||(b=!1)})})}if(b){if(ARKIA.WIZARD.FLIGHTS.temPassflights){for(var d=0;d<2;d++){var e=0==d?ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB:ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB;if($(".bodyMain.ltr").length)var f=0==d?"outbound":"inbound";else var f=0==d?"הלוך":"חזור";$.each(e,function(a,d){var e=d.SEATS_NO,g=0,h=0,i=0;$.each(d.PASSENGERS,function(a,b){"I"==b.OLD_SELECTED.AgeGroup?i++:"C"==b.OLD_SELECTED.AgeGroup?h++:g++}),g+h>e?(b=!1,$(".bodyMain.ltr").length?c[c.length]=MSG70.replace("{0}",f).replace("{1}","form "+d.DEP_STATION_NAME+" to "+d.ARR_STATION_NAME+", at "+d.DEP_TIME):c[c.length]=MSG70.replace("{0}",f).replace("{1}","מ"+d.DEP_STATION_NAME+" ל"+d.ARR_STATION_NAME+", בשעה "+d.DEP_TIME)):i>g?(b=!1,$(".bodyMain.ltr").length?c[c.length]=MSG71.replace("{0}",f).replace("{1}","from "+d.DEP_STATION_NAME+" to "+d.ARR_STATION_NAME+", at "+d.DEP_TIME):c[c.length]=MSG71.replace("{0}",f).replace("{1}","מ"+d.DEP_STATION_NAME+" ל"+d.ARR_STATION_NAME+", בשעה "+d.DEP_TIME)):i+h>0&&0==g&&(b=!1,$(".bodyMain.ltr").length?c[c.length]=MSG72.replace("{0}",f).replace("{1}","from "+d.DEP_STATION_NAME+" to "+d.ARR_STATION_NAME+", at "+d.DEP_TIME):c[c.length]=MSG72.replace("{0}",f).replace("{1}","מ"+d.DEP_STATION_NAME+" ל"+d.ARR_STATION_NAME+", בשעה "+d.DEP_TIME))})}if(b){ARKIA2.WIZARD.resetFlights();for(var d=0;d<2;d++){var e=0==d?ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB:ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB;$.each(e,function(a,b){var c=[];$.each(b.PASSENGERS,function(a,b){c.push(b.SELECT_CUSTOMER_NO)}),ARKIA2.WIZARD.AddFlight(b.FL_PRD_KEY,c)})}}}}else c.push(MSG69);return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}},ARKIA.WIZARD.PRODUCTS={temproducts:[],PRD05:{indexPage:0,pageCode:"PRD05",reLoad:!0,validate1Ticket:!0,includesEmbedPage:!0,controllerId:"ng_Ctrl_PRD05_2",adults:[],children:[],init:function(a,b,c,d){var e=this.controllerId;this.includesEmbedPage?$("#btnAddPrdCon"+c).click(function(){var a=!0,b=new Array,d=4;if(a){var f=ARKIA2.WIZARD.getAgeGroupCount();f.adults,f.children;$("#addPrdPart1"+c).hide(),$("#addPrdPart2"+c).show(),$("#buttonNextAddPrd"+c).show(),angular.element(document.getElementById(e)).scope().init(),angular.element(document.getElementById(e)).scope().$apply()}else errorValues[d]=ARKIA.WIZARD.createErrorListWizard(b);ARKIA.WIZARD.setError(d,!a),window.scrollTo(0,170)}):($("#btnAddPrdCon"+c).hide(),$("#buttonNextAddPrd"+c).show());var f="",g=[],h=[],i=[],j=!1;if(g=a.d.Products.Value,a.d.Products.Value){f="";var k=!1;$.each(g,function(a,b){0==b.CHILD_PRICEIsNull&&(b.CHILD_PRICE_FMT=eventsCurrency+b.CHILD_PRICE.formatMoney(0,".",","),b.CHILD_PRICE_FMT2=b.CHILD_PRICE.formatMoney(0,".",",")+eventsCurrency),0==b.ADULT_PRICEIsNull&&(b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",","),b.ADULT_PRICE_FMT2=b.ADULT_PRICE.formatMoney(0,".",",")+eventsCurrency),b.CHILD_PRICEIsNull==b.ADULT_PRICEIsNull&&b.CHILD_PRICE==b.ADULT_PRICE||(j=!0),b.CHILD_PRICEIsNull&&(k=!0);var c=ARKIA2.WIZARD.getPassengers();b.child=0,b.adult=0,b.adults=[],b.children=[],b.passengersA=[],b.passengersC=[],$.each(c,function(a,c){if(j){var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_END?(b.adult++,b.adults.push(b.adult),b.passengersA.push(c)):b.CHILD_AGE_START<=d&&d<b.CHILD_AGE_END&&(b.child++,b.children.push(b.child),b.passengersC.push(c))}else{var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_START&&(b.adult++,b.adults.push(b.adult),b.passengersA.push(c))}})}),k&&0==$("#ageMinMsg",b).length&&($("#infoBoxItems ul",b).length>0?$("#infoBoxItems ul",b).append('<li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li>"):$("#infoBoxItems",b).append('<div class="infoBox pieFix"><div class="infoBoxBubble"></div><ul><li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li></ul></div></div></div>")),ARKIA.WIZARD.PRODUCTS.temproducts[d]=g}return{totalPrice:f,products:g,adults:h,children:i,isChildPriceExists:j}},productsCtrl:["$scope","$http",function(a,b){var c=ARKIA.WIZARD.PRODUCTS.PRD05,d=c.indexPage;a.totalPrice="",a.products=[],a.adults=[],a.children=[],a.isChildPriceExists=!1,a.totalPriceText=MSG130,a.init=function(e,f){a.products&&!c.reLoad||b({url:"webmethods/AjaxMethods.aspx/GetAdditionalProducts",method:"POST",data:"{pageCode:'"+f+"'}",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,g,h,i){c.reLoad=!1;var j=c.init(b,e,f,d);a.totalPrice=j.totalPrice,a.products=j.products,c.adults=a.adults=j.adults,c.children=a.children=j.children,a.isChildPriceExists=j.isChildPriceExists,$("#showsLoader",e).hide(),$("#showsContent",e).show(),setTimeout(function(){$("#ng_Ctrl_PRD05 #adultTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='ADULT_PRICE']").text()+", "+$("#ng_Ctrl_PRD05 label#adultTicketsAmount").text())}),$("#ng_Ctrl_PRD05 #childTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='CHILD_PRICE']").text()+", "+$("#ng_Ctrl_PRD05 label#childTicketsAmount").text())}),$("#ng_Ctrl_PRD05 .responsive .selShowTickets").each(function(){$(this).attr("aria-label",$(this).parent().prev().text()+" "+$(this).next().text())})},100)}).error(function(a,b,c,d){window.location=errorPage})},a.addSum=function(){var b=0;$.each(a.products,function(a,c){null!=c.CHILDREN_PRD_NO&&(b+=c.CHILD_PRICE*c.CHILDREN_PRD_NO),null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""},a.clearSelected=function(){$.each(a.products,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),a.totalPrice=""},a.formatDate=function(a){var b=parseInt(a.replace(/[^0-9]/g,""));return new Date(b)}}],productsCtrl_2:["$scope","$http",function(a,b){a.init=function(){var b=ARKIA.WIZARD.PRODUCTS.PRD05,c=b.indexPage,d=b.pageCode;a.products=[];var e=!0;$.each(ARKIA.WIZARD.PRODUCTS.temproducts[c],function(b,c){if(c.ADULTS_PRD_NO>0||c.CHILDREN_PRD_NO>0){if(c.PASSENGERS=[],c.ADULTS_PRD_NO>0)for(var b=0;b<c.ADULTS_PRD_NO;b++){var d="";d=$(".bodyMain.ltr").length?"adult":"מבוגר";var f={VALUES:c.passengersA,AGE_GROUP:d+" ("+c.CHILD_AGE_END+"+)",SELECT_CUSTOMER_NO:c.ADULTS_PRD_NO==c.passengersA.length?c.passengersA[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.ADULT_PRICE,PRICE_CURRENCY:c.ADULT_PRICE_FMT};c.PASSENGERS.push(f),c.ADULTS_PRD_NO!=c.passengersA.length&&(e=!1)}if(c.CHILDREN_PRD_NO>0)for(var b=0;b<c.CHILDREN_PRD_NO;b++){var g="";g=$(".bodyMain.ltr").length?"child":"ילד";var f={VALUES:c.passengersC,AGE_GROUP:g+" ("+c.CHILD_AGE_START+"-"+c.CHILD_AGE_END+")",SELECT_CUSTOMER_NO:c.CHILDREN_PRD_NO==c.passengersC.length?c.passengersC[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.CHILD_PRICE,PRICE_CURRENCY:c.CHILD_PRICE_FMT};c.PASSENGERS.push(f),c.CHILDREN_PRD_NO!=c.passengersC.length&&(e=!1)}a.products.push(c)}}),e&&$("#buttonNextAddPrd"+d).click()},a.clearSelected=function(){a.init()},a.passengersChange=function(a,b,c){if(null!=b.OLD_SELECTED&&$.each(a.PASSENGERS,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.VALUES.push(b.OLD_SELECTED)}),null!=b.SELECT_CUSTOMER_NO&&$.each(a.PASSENGERS,function(a,c){c.SELECT_CUSTOMER_NO!=b.SELECT_CUSTOMER_NO&&(c.VALUES=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO!=b.SELECT_CUSTOMER_NO}))}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.SELECT_CUSTOMER_NO){var d=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO});b.OLD_SELECTED=d[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=this.indexPage,c=(this.validate1Ticket,this.includesEmbedPage),d=!0,e=new Array,f=!0;if($(".selectNamePrd05").each(function(a,b){$(this).val()<"0"&&(f=!1,d=!1,$(this).addClass("inputError"))}),ARKIA.WIZARD.PRODUCTS.temproducts[b]&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,b){}),d){if(f)return ARKIA2.WIZARD.resetProducts(b+1),ARKIA.WIZARD.PRODUCTS.temproducts&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,d){if(d.CHILDREN_PRD_NO>0||d.ADULTS_PRD_NO>0)if(c){var e=[];$.each(d.PASSENGERS,function(a,b){e.push(b.SELECT_CUSTOMER_NO)}),d.CUSTOMERS_NO=e,ARKIA2.WIZARD.AddProduct(b+1,d.AP_PRD_KEY,d.ADULTS_PRD_NO,d.CHILDREN_PRD_NO,d.CUSTOMERS_NO)}else ARKIA2.WIZARD.AddProduct(b+1,d.AP_PRD_KEY,d.ADULTS_PRD_NO,d.CHILDREN_PRD_NO)}),!0;ARKIA2.WIZARD.resetProducts(b+1),e.push(MSG480),errorValues[a]=ARKIA.WIZARD.createErrorListWizard(e)}else!d&&f&&(ARKIA2.WIZARD.resetProducts(b+1),e.push(MSG133),errorValues[a]=ARKIA.WIZARD.createErrorListWizard(e));return d}}},ARKIA.WIZARD.PRODUCTS.PRD06={indexPage:1,pageCode:"PRD06",reLoad:!0,validate1Ticket:!1,includesEmbedPage:!0,controllerId:"ng_Ctrl_PRD06_2",adults:[],children:[],init:function(a,b,c,d){var e=this.controllerId;this.includesEmbedPage?$("#btnAddPrdCon"+c).click(function(){var a=!0,b=new Array,d=4;if(a){var f=ARKIA2.WIZARD.getAgeGroupCount();f.adults,f.children;$("#addPrdPart1"+c).hide(),$("#addPrdPart2"+c).show(),$("#buttonNextAddPrd"+c).show(),angular.element(document.getElementById(e)).scope().init(),angular.element(document.getElementById(e)).scope().$apply()}else errorValues[d]=ARKIA.WIZARD.createErrorListWizard(b);ARKIA.WIZARD.setError(d,!a),window.scrollTo(0,170)}):($("#btnAddPrdCon"+c).hide(),$("#buttonNextAddPrd"+c).show());var f="",g=[],h=[],i=[],j=!1;if(g=a.d.Products.Value,a.d.Products.Value){f="";var k=!1;$.each(g,function(a,b){0==b.CHILD_PRICEIsNull&&(b.CHILD_PRICE_FMT=eventsCurrency+b.CHILD_PRICE.formatMoney(0,".",","),b.CHILD_PRICE_FMT2=b.CHILD_PRICE.formatMoney(0,".",",")+eventsCurrency),0==b.ADULT_PRICEIsNull&&(b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",","),b.ADULT_PRICE_FMT2=b.ADULT_PRICE.formatMoney(0,".",",")+eventsCurrency),b.CHILD_PRICEIsNull==b.ADULT_PRICEIsNull&&b.CHILD_PRICE==b.ADULT_PRICE||(j=!0),b.CHILD_PRICEIsNull&&(k=!0);var c=ARKIA2.WIZARD.getPassengers();b.child=0,b.adult=0,b.adults=[],b.children=[],b.passengersA=[],b.passengersC=[],$.each(c,function(a,c){if(j){var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_END?(b.adult++,b.adults.push(b.adult),b.passengersA.push(c)):b.CHILD_AGE_START<=d&&d<b.CHILD_AGE_END&&(b.child++,b.children.push(b.child),b.passengersC.push(c))}else{var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_START&&(b.adult++,b.adults.push(b.adult),b.passengersA.push(c))}})}),k&&0==$("#ageMinMsg",b).length&&($("#infoBoxItems ul",b).length>0?$("#infoBoxItems ul",b).append('<li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li>"):$("#infoBoxItems",b).append('<div class="infoBox pieFix"><div class="infoBoxBubble"></div><ul><li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li></ul></div></div></div>")),ARKIA.WIZARD.PRODUCTS.temproducts[d]=g}return{totalPrice:f,products:g,adults:h,children:i,isChildPriceExists:j}},productsCtrl:["$scope","$http",function(a,b){var c=ARKIA.WIZARD.PRODUCTS.PRD06,d=c.indexPage;a.totalPrice="",a.products=[],a.adults=[],a.children=[],a.isChildPriceExists=!1,a.totalPriceText=MSG130,a.init=function(e,f){a.products&&!c.reLoad||b({url:"webmethods/AjaxMethods.aspx/GetAdditionalProducts",method:"POST",data:"{pageCode:'"+f+"'}",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,g,h,i){c.reLoad=!1;var j=c.init(b,e,f,d);a.totalPrice=j.totalPrice,a.products=j.products,c.adults=a.adults=j.adults,c.children=a.children=j.children,a.isChildPriceExists=j.isChildPriceExists,$("#showsLoader",e).hide(),$("#showsContent",e).show(),setTimeout(function(){$("#ng_Ctrl_PRD06 #adultTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='ADULT_PRICE']").text()+", "+$("#ng_Ctrl_PRD06 label#adultTicketsAmount").text())}),$("#ng_Ctrl_PRD06 #childTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='CHILD_PRICE']").text()+", "+$("#ng_Ctrl_PRD06 label#childTicketsAmount").text())}),$("#ng_Ctrl_PRD06 .responsive .selShowTickets").each(function(){$(this).attr("aria-label",$(this).parent().prev().text()+" "+$(this).next().text())})},100)}).error(function(a,b,c,d){window.location=errorPage})},a.addSum=function(){var b=0;$.each(a.products,function(a,c){null!=c.CHILDREN_PRD_NO&&(b+=c.CHILD_PRICE*c.CHILDREN_PRD_NO),null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""},a.clearSelected=function(){$.each(a.products,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),a.totalPrice=""},a.formatDate=function(a){var b=parseInt(a.replace(/[^0-9]/g,""));return new Date(b)}}],productsCtrl_2:["$scope","$http",function(a,b){a.init=function(){var b=ARKIA.WIZARD.PRODUCTS.PRD06,c=b.indexPage,d=b.pageCode;a.products=[];var e=!0;$.each(ARKIA.WIZARD.PRODUCTS.temproducts[c],function(b,c){if(c.ADULTS_PRD_NO>0||c.CHILDREN_PRD_NO>0){if(c.PASSENGERS=[],c.ADULTS_PRD_NO>0)for(var b=0;b<c.ADULTS_PRD_NO;b++){var d="";d=$(".bodyMain.ltr").length?"adult":"מבוגר";var f={VALUES:c.passengersA,AGE_GROUP:d+" ("+c.CHILD_AGE_END+"+)",SELECT_CUSTOMER_NO:c.ADULTS_PRD_NO==c.passengersA.length?c.passengersA[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.ADULT_PRICE,PRICE_CURRENCY:c.ADULT_PRICE_FMT};c.PASSENGERS.push(f),c.ADULTS_PRD_NO!=c.passengersA.length&&(e=!1)}if(c.CHILDREN_PRD_NO>0)for(var b=0;b<c.CHILDREN_PRD_NO;b++){var g="";g=$(".bodyMain.ltr").length?"child":"ילד";var f={VALUES:c.passengersC,AGE_GROUP:g+" ("+c.CHILD_AGE_START+"-"+c.CHILD_AGE_END+")",SELECT_CUSTOMER_NO:c.CHILDREN_PRD_NO==c.passengersC.length?c.passengersC[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.CHILD_PRICE,PRICE_CURRENCY:c.CHILD_PRICE_FMT};c.PASSENGERS.push(f),c.CHILDREN_PRD_NO!=c.passengersC.length&&(e=!1)}a.products.push(c)}}),setTimeout(function(){$("#ng_Ctrl_PRD06_2 .passItem .selectName").each(function(){$(".bodyMain.ltr").length?$(this).attr("aria-label",$(this).parents(".passItemBox").find(".greyPanel").text()+" "+$(this).prev().text()+$(this).next().text()+", select participant"):$(this).attr("aria-label",$(this).parents(".passItemBox").find(".greyPanel").text()+" "+$(this).prev().text()+$(this).next().text()+", בחר משתתף")})},100),e&&$("#buttonNextAddPrd"+d).click()},a.clearSelected=function(){a.init()},a.passengersChange=function(a,b,c){if(null!=b.OLD_SELECTED&&$.each(a.PASSENGERS,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.VALUES.push(b.OLD_SELECTED)}),null!=b.SELECT_CUSTOMER_NO&&$.each(a.PASSENGERS,function(a,c){c.SELECT_CUSTOMER_NO!=b.SELECT_CUSTOMER_NO&&(c.VALUES=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO!=b.SELECT_CUSTOMER_NO}))}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.SELECT_CUSTOMER_NO){var d=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO});b.OLD_SELECTED=d[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=this.indexPage,c=this.validate1Ticket,d=this.includesEmbedPage,e=!0,f=new Array;return ARKIA.WIZARD.PRODUCTS.temproducts[b]&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,d){if(c){var f=jQuery.grep(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a){return a.EXECUTION_START_DATE==d.EXECUTION_START_DATE&&a.CHILD_AGE_START==d.CHILD_AGE_START&&a.CHILD_AGE_END==d.CHILD_AGE_END}),g=0;$.each(f,function(a,b){g+=b.ADULTS_PRD_NO?b.ADULTS_PRD_NO:0}),g>d.adults.length&&(e=!1),g=0,$.each(f,function(a,b){g+=b.CHILDREN_PRD_NO?b.CHILDREN_PRD_NO:0}),g>d.children.length&&(e=!1)}}),e?(ARKIA2.WIZARD.resetProducts(b+1),ARKIA.WIZARD.PRODUCTS.temproducts&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,c){if(c.CHILDREN_PRD_NO>0||c.ADULTS_PRD_NO>0)if(d){var e=[];$.each(c.PASSENGERS,function(a,b){e.push(b.SELECT_CUSTOMER_NO)}),c.CUSTOMERS_NO=e,ARKIA2.WIZARD.AddProduct(b+1,c.AP_PRD_KEY,c.ADULTS_PRD_NO,c.CHILDREN_PRD_NO,c.CUSTOMERS_NO)}else ARKIA2.WIZARD.AddProduct(b+1,c.AP_PRD_KEY,c.ADULTS_PRD_NO,c.CHILDREN_PRD_NO)}),!0):(ARKIA2.WIZARD.resetProducts(b+1),f.push(MSG134),errorValues[a]=ARKIA.WIZARD.createErrorListWizard(f),e)}},ARKIA.WIZARD.PRODUCTS.PRD07={indexPage:2,pageCode:"PRD07",reLoad:!0,validate1Ticket:!1,includesEmbedPage:!0,controllerId:"ng_Ctrl_PRD07_2",adults:[],children:[],init:function(a,b,c,d){var e=this.controllerId;this.includesEmbedPage?$("#btnAddPrdCon"+c).click(function(){var a=!0,b=new Array,d=4;if(a){var f=ARKIA2.WIZARD.getAgeGroupCount();f.adults,f.children;$("#addPrdPart1"+c).hide(),$("#addPrdPart2"+c).show(),$("#buttonNextAddPrd"+c).show(),angular.element(document.getElementById(e)).scope().init(),angular.element(document.getElementById(e)).scope().$apply()}else errorValues[d]=ARKIA.WIZARD.createErrorListWizard(b);ARKIA.WIZARD.setError(d,!a),window.scrollTo(0,170)}):($("#btnAddPrdCon"+c).hide(),$("#buttonNextAddPrd"+c).show());var f="",g=[],h=[],i=[],j=!1;if(g=a.d.Products.Value,a.d.Products.Value){f="";var k=!1;$.each(g,function(a,b){0==b.CHILD_PRICEIsNull&&(b.CHILD_PRICE_FMT=eventsCurrency+b.CHILD_PRICE.formatMoney(0,".",",")),0==b.ADULT_PRICEIsNull&&(b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",",")),b.CHILD_PRICEIsNull==b.ADULT_PRICEIsNull&&b.CHILD_PRICE==b.ADULT_PRICE||(j=!0),b.CHILD_PRICEIsNull&&(k=!0);var c=ARKIA2.WIZARD.getPassengers();b.child=0,b.adult=0,b.adults=[],b.children=[],b.passengersA=[],b.passengersC=[],$.each(c,function(a,c){if(j){var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_END?(b.adult++,b.adults.push(b.adult),b.passengersA.push(c)):b.CHILD_AGE_START<=d&&d<b.CHILD_AGE_END&&(b.child++,b.children.push(b.child),b.passengersC.push(c))}else{var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=b.CHILD_AGE_START&&(b.adult++,b.adults.push(b.adult),b.passengersA.push(c))}})}),k&&0==$("#ageMinMsg",b).length&&($("#infoBoxItems ul",b).length>0?$("#infoBoxItems ul",b).append('<li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li>"):$("#infoBoxItems",b).append('<div class="infoBox pieFix"><div class="infoBoxBubble"></div><ul><li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li></ul></div></div></div>")),ARKIA.WIZARD.PRODUCTS.temproducts[d]=g}return{totalPrice:f,products:g,adults:h,children:i,isChildPriceExists:j}},productsCtrl:["$scope","$http",function(a,b){var c=ARKIA.WIZARD.PRODUCTS.PRD07,d=c.indexPage;a.totalPrice="",a.products=[],a.adults=[],a.children=[],a.isChildPriceExists=!1,a.totalPriceText=MSG130,a.init=function(e,f){a.products&&!c.reLoad||b({url:"webmethods/AjaxMethods.aspx/GetAdditionalProducts",method:"POST",data:"{pageCode:'"+f+"'}",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,g,h,i){c.reLoad=!1;var j=c.init(b,e,f,d);a.totalPrice=j.totalPrice,a.products=j.products,c.adults=a.adults=j.adults,c.children=a.children=j.children,a.isChildPriceExists=j.isChildPriceExists,$("#showsLoader",e).hide(),$("#showsContent",e).show(),setTimeout(function(){$("#ng_Ctrl_PRD07 #adultTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='ADULT_PRICE']").text()+", "+$("#ng_Ctrl_PRD07 label#adultTicketsAmount").text())}),$("#ng_Ctrl_PRD07 #childTickets").each(function(){$(this).attr("aria-label",$(this).parents(".feesRow").find(".colShowName").text()+", "+$(this).parents(".feesRow").find("[role='CHILD_PRICE']").text()+", "+$("#ng_Ctrl_PRD07 label#childTicketsAmount").text())}),$("#ng_Ctrl_PRD07 .responsive .selShowTickets").each(function(){$(this).attr("aria-label",$(this).parent().prev().text()+" "+$(this).next().text())})},100)}).error(function(a,b,c,d){window.location=errorPage})},a.addSum=function(){var b=0;$.each(a.products,function(a,c){null!=c.CHILDREN_PRD_NO&&(b+=c.CHILD_PRICE*c.CHILDREN_PRD_NO),null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""},a.clearSelected=function(){$.each(a.products,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),a.totalPrice=""},a.formatDate=function(a){var b=parseInt(a.replace(/[^0-9]/g,""));return new Date(b)}}],productsCtrl_2:["$scope","$http",function(a,b){a.init=function(){var b=ARKIA.WIZARD.PRODUCTS.PRD07,c=b.indexPage,d=b.pageCode;a.products=[];var e=!0;$.each(ARKIA.WIZARD.PRODUCTS.temproducts[c],function(b,c){if(c.ADULTS_PRD_NO>0||c.CHILDREN_PRD_NO>0){if(c.PASSENGERS=[],c.ADULTS_PRD_NO>0)for(var b=0;b<c.ADULTS_PRD_NO;b++){var d="";d=$(".bodyMain.ltr").length?"adult":"מבוגר";var f={VALUES:c.passengersA,AGE_GROUP:d+" ("+c.CHILD_AGE_END+"+)",SELECT_CUSTOMER_NO:c.ADULTS_PRD_NO==c.passengersA.length?c.passengersA[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.ADULT_PRICE,PRICE_CURRENCY:c.ADULT_PRICE_FMT};c.PASSENGERS.push(f),c.ADULTS_PRD_NO!=c.passengersA.length&&(e=!1)}if(c.CHILDREN_PRD_NO>0)for(var b=0;b<c.CHILDREN_PRD_NO;b++){var g="";g=$(".bodyMain.ltr").length?"child":"ילד";var f={VALUES:c.passengersC,AGE_GROUP:g+" ("+c.CHILD_AGE_START+"-"+c.CHILD_AGE_END+")",SELECT_CUSTOMER_NO:c.CHILDREN_PRD_NO==c.passengersC.length?c.passengersC[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.CHILD_PRICE,PRICE_CURRENCY:c.CHILD_PRICE_FMT};c.PASSENGERS.push(f),c.CHILDREN_PRD_NO!=c.passengersC.length&&(e=!1)}a.products.push(c)}}),setTimeout(function(){$("#ng_Ctrl_PRD07_2 .passItem .selectName").each(function(){$(".bodyMain.ltr").length?$(this).attr("aria-label",$(this).parents(".passItemBox").find(".greyPanel").text()+" "+$(this).prev().text()+$(this).next().text()+", select participant"):$(this).attr("aria-label",$(this).parents(".passItemBox").find(".greyPanel").text()+" "+$(this).prev().text()+$(this).next().text()+", בחר משתתף")})},100),e&&$("#buttonNextAddPrd"+d).click()},a.clearSelected=function(){a.init()},a.passengersChange=function(a,b,c){if(null!=b.OLD_SELECTED&&$.each(a.PASSENGERS,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.VALUES.push(b.OLD_SELECTED)}),null!=b.SELECT_CUSTOMER_NO&&$.each(a.PASSENGERS,function(a,c){c.SELECT_CUSTOMER_NO!=b.SELECT_CUSTOMER_NO&&(c.VALUES=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO!=b.SELECT_CUSTOMER_NO}))}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.SELECT_CUSTOMER_NO){var d=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO});b.OLD_SELECTED=d[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=this.indexPage,c=this.validate1Ticket,d=this.includesEmbedPage,e=!0,f=new Array;return ARKIA.WIZARD.PRODUCTS.temproducts[b]&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,d){if(c){var f=jQuery.grep(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a){return a.EXECUTION_START_DATE==d.EXECUTION_START_DATE&&a.CHILD_AGE_START==d.CHILD_AGE_START&&a.CHILD_AGE_END==d.CHILD_AGE_END}),g=0;$.each(f,function(a,b){g+=b.ADULTS_PRD_NO?b.ADULTS_PRD_NO:0}),g>d.adults.length&&(e=!1),g=0,$.each(f,function(a,b){g+=b.CHILDREN_PRD_NO?b.CHILDREN_PRD_NO:0}),g>d.children.length&&(e=!1)}}),e?(ARKIA2.WIZARD.resetProducts(b+1),ARKIA.WIZARD.PRODUCTS.temproducts&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts[b],function(a,c){if(c.CHILDREN_PRD_NO>0||c.ADULTS_PRD_NO>0)if(d){var e=[];$.each(c.PASSENGERS,function(a,b){e.push(b.SELECT_CUSTOMER_NO)}),c.CUSTOMERS_NO=e,ARKIA2.WIZARD.AddProduct(b+1,c.AP_PRD_KEY,c.ADULTS_PRD_NO,c.CHILDREN_PRD_NO,c.CUSTOMERS_NO)}else ARKIA2.WIZARD.AddProduct(b+1,c.AP_PRD_KEY,c.ADULTS_PRD_NO,c.CHILDREN_PRD_NO)}),!0):(ARKIA2.WIZARD.resetProducts(b+1),f.push(MSG135),errorValues[a]=ARKIA.WIZARD.createErrorListWizard(f),e)}},ARKIA.WIZARD.MEALS={init:function(a,b,c,d){$("#btnMealsCon").click(function(){var a=!0,b=new Array,c=4,d=0;if($.each(ARKIA.WIZARD.MEALS.temproducts[0],function(a,b){b.CHILDREN_PRD_NO&&(d+=b.CHILDREN_PRD_NO),b.ADULTS_PRD_NO&&(d+=b.ADULTS_PRD_NO)}),0==d&&0==$("#cbNoLunch:checkbox:checked").length?(a=!1,ARKIA2.WIZARD.resetMeal(),b.push(MSG133),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b)):d>0&&1==$("#cbNoLunch:checkbox:checked").length&&(a=!1,ARKIA2.WIZARD.resetMeal(),b.push(MSG318),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b)),a)if(1==$("#cbNoLunch:checkbox:checked").length)ARKIA2.WIZARD.resetMeal(),$("#buttonNextMeals").click();else{var e=ARKIA2.WIZARD.getAgeGroupCount();e.adults,e.children;$("#mealsPart1").hide(),$("#mealsPart2").show(),angular.element(document.getElementById("ng_Ctrl_PRD13_MEALS")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD13_MEALS")).scope().$apply()}else errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b);ARKIA.WIZARD.setError(c,!a),window.scrollTo(0,170)});var e="",f=[],g=[],h=[],i=!1;if(f=a.d.Products.Value,a.d.Products.Value){e="";var j=!1;$.each(f,function(a,b){0==b.CHILD_PRICEIsNull&&(b.CHILD_PRICE_FMT=eventsCurrency+b.CHILD_PRICE.formatMoney(0,".",",")),0==b.ADULT_PRICEIsNull&&(b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",","),b.ADULT_PRICE_FMT2=b.ADULT_PRICE.formatMoney(0,".",",")+eventsCurrency),b.CHILD_PRICEIsNull==b.ADULT_PRICEIsNull&&b.CHILD_PRICE==b.ADULT_PRICE||(i=!0),b.CHILD_PRICEIsNull&&(j=!0)}),j&&0==$("#ageMinMsg",b).length&&($("#infoBoxItems ul",b).length>0?$("#infoBoxItems ul",b).append('<li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li>"):$("#infoBoxItems",b).append('<div class="infoBox pieFix"><div class="infoBoxBubble"></div><ul><li id="ageMinMsg">'+MSG93.replace("{0}",a.d.ChildAgeStart)+"</li></ul></div></div></div>"));var k=ARKIA2.WIZARD.getReservation(),l=0,m=1;g=[],h=[],g.push(1),null!=k.COMPANIONS&&$.each(k.COMPANIONS.Value,function(b,c){if(i){var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>a.d.ChildAgeEnd?(m++,g.push(m)):a.d.ChildAgeStart<=d&&d<a.d.ChildAgeEnd&&(l++,h.push(l))}else{var d=ARKIA2.WIZARD.getAgeByDate(c.DOB.toString());d>=a.d.ChildAgeStart&&(m++,g.push(m))}}),ARKIA.WIZARD.MEALS.temproducts[d]=f}return{totalPrice:e,products:f,adults:g,children:h,isChildPriceExists:i}},temproducts:[],PRD13:{reLoad:!0,productsCtrl:["$scope","$http",function(a,b){var c=ARKIA.WIZARD.MEALS.PRD13;a.totalPrice="",a.products=[],a.adults=[],a.children=[],a.isChildPriceExists=!1,a.totalPriceText=MSG130,a.init=function(){var d=$("#ng_Ctrl_PRD13"),e="PRD13";a.hotelName=ARKIA.WIZARD.HOTELS.roomsChecked.hotel.HOTEL_NAME,a.products&&!c.reLoad||b({url:"webmethods/AjaxMethods.aspx/GetAdditionalProducts",method:"POST",data:"{pageCode:'"+e+"'}",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,f,g,h){c.reLoad=!1;var i=ARKIA.WIZARD.MEALS.init(b,d,e,0);a.totalPrice=i.totalPrice,a.products=i.products,a.adults=i.adults,a.children=i.children,a.isChildPriceExists=i.isChildPriceExists,$("#showsLoader",d).hide(),$("#showsContent",d).show()}).error(function(a,b,c,d){window.location=errorPage})},a.addSum=function(){var b=0;$.each(a.products,function(a,c){null!=c.CHILDREN_PRD_NO&&(b+=c.CHILD_PRICE*c.CHILDREN_PRD_NO),null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""},a.clearSelected=function(){$.each(a.products,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),a.totalPrice=""},a.formatDate=function(a){var b=parseInt(a.replace(/[^0-9]/g,""));return new Date(b)}}],productsCtrl_2:["$scope","$http",function(a,b){a.init=function(){a.hotelName=ARKIA.WIZARD.HOTELS.roomsChecked.hotel.HOTEL_NAME;var b=ARKIA2.WIZARD.getPassengers();b=jQuery.grep(b,function(a){return"I"!=a.AgeGroup}),ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals=[];for(var c=ARKIA.WIZARD.MEALS.temproducts[0][0].ADULTS_PRD_NO,d=0;d<c;d++){var e={AGE_GROUP:"מבוגר",VALUES:b,SELECT_CUSTOMER_NO:c==b.length?b[d].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:ARKIA.WIZARD.MEALS.temproducts[0][0].ADULT_PRICE,PRICE_CURRENCY:ARKIA.WIZARD.MEALS.temproducts[0][0].ADULT_PRICE_FMT};ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals.push(e)}a.productsMeals=ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals,setTimeout(function(){$("#ng_Ctrl_PRD13_MEALS .passItem .selectName").each(function(){$(".bodyMain.ltr").length?$(this).attr("aria-label",$(this).parents(".ribbonBox").find(".marginRight10").text()+$(this).next().text()+", select participant"):$(this).attr("aria-label",$(this).parents(".ribbonBox").find(".marginRight10").text()+$(this).next().text()+", בחר משתתף")})},100),c==b.length&&$("#buttonNextMeals").click()},a.clearSelected=function(){a.init()},a.passengersChange=function(b){if(null!=b.OLD_SELECTED&&$.each(a.productsMeals,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.AGE_GROUP==b.AGE_GROUP&&c.VALUES.push(b.OLD_SELECTED)}),null!=b.SELECT_CUSTOMER_NO&&$.each(a.productsMeals,function(a,c){c.SELECT_CUSTOMER_NO!=b.SELECT_CUSTOMER_NO&&(c.VALUES=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO!=b.SELECT_CUSTOMER_NO}))}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.SELECT_CUSTOMER_NO){var c=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO});b.OLD_SELECTED=c[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=!0,c=new Array;if(ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals)if($.each(ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals,function(a,c){0==c.SELECT_CUSTOMER_NO&&(b=!1)}),b){var d=[];$.each(ARKIA.WIZARD.MEALS.temproducts[0][0].productsMeals,function(a,b){d.push(b.SELECT_CUSTOMER_NO)}),ARKIA.WIZARD.MEALS.temproducts[0][0].CUSTOMERS_NO=d,ARKIA2.WIZARD.resetMeal(),ARKIA.WIZARD.MEALS.temproducts&&$.each(ARKIA.WIZARD.MEALS.temproducts,function(a,b){$.each(b,function(a,b){(b.CHILDREN_PRD_NO>0||b.ADULTS_PRD_NO>0)&&ARKIA2.WIZARD.AddMeal(b.AP_PRD_KEY,b.ADULTS_PRD_NO,b.CHILDREN_PRD_NO,b.CUSTOMERS_NO)})})}else c.push(MSG323);return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.SHUTTLE.init()}),ARKIA.WIZARD.SHUTTLE={init:function(){$("#btShuttleCon").click(function(){var a=!0,b=new Array,c=6,d=0,e=0;$.each(ARKIA.WIZARD.SHUTTLE.temproducts[0],function(a,b){b.ADULTS_PRD_NO&&(d+=b.ADULTS_PRD_NO)}),$.each(ARKIA.WIZARD.SHUTTLE.temproducts[1],function(a,b){b.ADULTS_PRD_NO&&(e+=b.ADULTS_PRD_NO)}),d+e==0&&0==$("#cbNoShuttle:checkbox:checked").length?(a=!1,ARKIA2.WIZARD.resetShuttle(),b.push(MSG343),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b)):d+e>0&&1==$("#cbNoShuttle:checkbox:checked").length&&(a=!1,ARKIA2.WIZARD.resetShuttle(),b.push(MSG342),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b)),(d>ARKIA.WIZARD.SHUTTLE.passProducts1.length||e>ARKIA.WIZARD.SHUTTLE.passProducts2.length)&&(a=!1,ARKIA2.WIZARD.resetShuttle(),b.push(MSG341),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b)),a?1==$("#cbNoShuttle:checkbox:checked").length?(ARKIA2.WIZARD.resetShuttle(),$("#buttonNextShuttle").click()):($("#shuttlePart1").hide(),$("#shuttlePart2").show(),angular.element(document.getElementById("ng_Ctrl_PRD09_PART2")).scope().init(),angular.element(document.getElementById("ng_Ctrl_PRD09_PART2")).scope().$apply()):errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b),ARKIA.WIZARD.setError(c,!a),window.scrollTo(0,170)})},temproducts:[],passProducts1:[],passProducts2:[],reLoad:!0,productsCtrl:["$scope","$http",function(a,b){var c=ARKIA.WIZARD.SHUTTLE;a.totalPrice="",a.products=[],a.adults=[],a.children=[],a.isChildPriceExists=!1,a.totalPriceText=MSG344,a.init=function(){var d=$("#ng_Ctrl_PRD09");a.hotelName=ARKIA.WIZARD.HOTELS.roomsChecked.hotel.HOTEL_NAME,a.products&&!c.reLoad||b({url:"webmethods/AjaxMethods.aspx/GetShuttles",method:"POST",data:"{pageCode1:'PRD11',pageCode2:'PRD12'}",headers:{"Content-Type":"application/json; charset=utf-8"}}).success(function(b,e,f,g){c.reLoad=!1;var h="",i=[],j=[];i=b.d.Products1.Value,j=b.d.Products2.Value,h="",$.each(i,function(a,b){b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",","),b.ADULT_PRICE_FMT2=b.ADULT_PRICE.formatMoney(0,".",",")+eventsCurrency}),$.each(j,function(a,b){b.ADULT_PRICE_FMT=eventsCurrency+b.ADULT_PRICE.formatMoney(0,".",","),b.ADULT_PRICE_FMT2=b.ADULT_PRICE.formatMoney(0,".",",")+eventsCurrency});var k=ARKIA2.WIZARD.getAgeGroupCount(),l=k.adults+k.children+k.infants,m=0,n=0;$.each(ARKIA.WIZARD.FLIGHTS.temflights.itemsOB,function(a,b){$.each(b.FLIGHTS.Value,function(a,b){b.selectPassNo&&(m+=b.selectPassNo)})}),$.each(ARKIA.WIZARD.FLIGHTS.temflights.itemsIB,function(a,b){$.each(b.FLIGHTS.Value,function(a,b){b.selectPassNo&&(n+=b.selectPassNo)})});var k=ARKIA2.WIZARD.getAgeGroupCount(),l=k.adults+k.children+k.infants;if(ARKIA.WIZARD.SHUTTLE.passProducts1=[],ARKIA.WIZARD.SHUTTLE.passProducts2=[],m<l)for(var o=0;o<l-m;o++)ARKIA.WIZARD.SHUTTLE.passProducts1.push(o+1);if(n<l)for(var o=0;o<l-n;o++)ARKIA.WIZARD.SHUTTLE.passProducts2.push(o+1);ARKIA.WIZARD.SHUTTLE.temproducts[0]=i,ARKIA.WIZARD.SHUTTLE.temproducts[1]=j,a.obShuttle=m<l,a.ibShuttle=n<l,a.totalPrice=h,a.products1=i,a.products2=j,a.passProducts1=ARKIA.WIZARD.SHUTTLE.passProducts1,a.passProducts2=ARKIA.WIZARD.SHUTTLE.passProducts2,$("#showsLoader",d).hide(),$("#showsContent",d).show()}).error(function(a,b,c,d){window.location=errorPage})},a.addSum=function(){var b=0;$.each(a.products1,function(a,c){null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),$.each(a.products2,function(a,c){null!=c.ADULTS_PRD_NO&&(b+=c.ADULT_PRICE*c.ADULTS_PRD_NO)}),a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""},a.clearSelected=function(){$.each(a.products1,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),$.each(a.products2,function(a,b){b.CHILDREN_PRD_NO=b.ADULTS_PRD_NO=null}),a.totalPrice=""},a.formatDate=function(a){var b=parseInt(a.replace(/[^0-9]/g,""));return new Date(b)}}],productsCtrl_2:["$scope","$http",function(a,b){a.init=function(){var b=ARKIA2.WIZARD.getPassengers(),c=[],d=[],e=[];if(ARKIA.WIZARD.FLIGHTS.temPassflights){ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB&&(e=ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB),$.each(e,function(a,b){$.each(b.PASSENGERS,function(a,b){c.push(b.SELECT_CUSTOMER_NO)})});var e=[];ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB&&(e=ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB),$.each(e,function(a,b){$.each(b.PASSENGERS,function(a,b){d.push(b.SELECT_CUSTOMER_NO)})})}var f=[],g=[];jQuery.grep(b,function(a){-1==jQuery.inArray(a.CUSTOMER_NO,c)&&f.push(a)}),jQuery.grep(b,function(a){-1==jQuery.inArray(a.CUSTOMER_NO,d)&&g.push(a)}),a.products1=[],a.products2=[];var h=jQuery.grep(ARKIA.WIZARD.SHUTTLE.temproducts[0],function(a){return a.ADULTS_PRD_NO>0});$.each(ARKIA.WIZARD.SHUTTLE.temproducts[0],function(b,c){if(c.ADULTS_PRD_NO>0){c.PASSENGERS=[];for(var b=0;b<c.ADULTS_PRD_NO;b++){var d={VALUES:f,SELECT_CUSTOMER_NO:1==h.length&&c.ADULTS_PRD_NO==f.length?f[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.ADULT_PRICE,PRICE_CURRENCY:c.ADULT_PRICE_FMT};c.PASSENGERS.push(d)}a.products1.push(c)}});var i=jQuery.grep(ARKIA.WIZARD.SHUTTLE.temproducts[1],function(a){return a.ADULTS_PRD_NO>0});$.each(ARKIA.WIZARD.SHUTTLE.temproducts[1],function(b,c){if(c.ADULTS_PRD_NO>0){c.PASSENGERS=[];for(var b=0;b<c.ADULTS_PRD_NO;b++){var d={VALUES:g,SELECT_CUSTOMER_NO:1==i.length&&c.ADULTS_PRD_NO==g.length?g[b].CUSTOMER_NO:0,OLD_SELECTED:null,PRICE:c.ADULT_PRICE,PRICE_CURRENCY:c.ADULT_PRICE_FMT};c.PASSENGERS.push(d)}a.products2.push(c)}}),setTimeout(function(){$("#ng_Ctrl_PRD09_PART2 .passItem .selectName").each(function(){$(".bodyMain.ltr").length?$(this).attr("aria-label",$(this).parents(".items").find(".greyPanel").text()+$(this).next().text()+" select passenger"):$(this).attr("aria-label",$(this).parents(".items").find(".greyPanel").text()+$(this).next().text()+" בחר נוסע")})},100),(0==h.length||1==h.length&&h[0].ADULTS_PRD_NO==f.length)&&(0==i.length||1==i.length&&i[0].ADULTS_PRD_NO==g.length)&&$("#buttonNextShuttle").click()},a.clearSelected=function(){a.init()},a.passengersChange=function(a,b,c){if(null!=b.OLD_SELECTED&&$.each(c,function(a,c){$.each(c.PASSENGERS,function(a,c){c.OLD_SELECTED!=b.OLD_SELECTED&&c.VALUES.push(b.OLD_SELECTED)})}),null!=b.SELECT_CUSTOMER_NO&&$.each(c,function(a,c){$.each(c.PASSENGERS,function(a,c){c.SELECT_CUSTOMER_NO!=b.SELECT_CUSTOMER_NO&&(c.VALUES=jQuery.grep(c.VALUES,function(a){return a.CUSTOMER_NO!=b.SELECT_CUSTOMER_NO}))})}),angular.forEach($("select"),function(a){a.options[a.selectedIndex].text+=" "}),null!=b.SELECT_CUSTOMER_NO){var d=jQuery.grep(b.VALUES,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO});b.OLD_SELECTED=d[0]}else b.OLD_SELECTED=null}}],ValidateStep:function(a){var b=!0,c=new Array;if(b){ARKIA2.WIZARD.resetShuttle();var d=ARKIA.WIZARD.SHUTTLE.temproducts[0];$.each(d,function(a,c){c.ADULTS_PRD_NO>0&&$.each(c.PASSENGERS,function(a,c){0==c.SELECT_CUSTOMER_NO&&(b=!1)})});var d=ARKIA.WIZARD.SHUTTLE.temproducts[1];if($.each(d,function(a,c){c.ADULTS_PRD_NO>0&&$.each(c.PASSENGERS,function(a,c){0==c.SELECT_CUSTOMER_NO&&(b=!1)})}),b){var d=ARKIA.WIZARD.SHUTTLE.temproducts[0];$.each(d,function(a,b){if(b.ADULTS_PRD_NO>0){var c=[];$.each(b.PASSENGERS,function(a,b){c.push(b.SELECT_CUSTOMER_NO)}),ARKIA2.WIZARD.AddShuttle(b.AP_PRD_KEY,c)}});var d=ARKIA.WIZARD.SHUTTLE.temproducts[1];$.each(d,function(a,b){if(b.ADULTS_PRD_NO>0){var c=[];$.each(b.PASSENGERS,function(a,b){c.push(b.SELECT_CUSTOMER_NO)}),ARKIA2.WIZARD.AddShuttle(b.AP_PRD_KEY,c)}})}else c.push(MSG324)}return b||(errorValues[a]=ARKIA.WIZARD.createErrorListWizard(c)),b}},$(function(){$("#wizard").exists()&&ARKIA.WIZARD.SUMMARY.init()}),ARKIA.WIZARD.SUMMARY={init:function(){(window.location.href.indexOf("dev")>-1||window.location.href.indexOf("192.168.84.25")>-1)&&$("#cbReg").prop("checked",!0);var a=function(){$("#btnFinish").unbind("click",a);var b=new Array;$(".inputError").removeClass("inputError");var c=7,d=!0;if($("#cbReg").length>0&&($("#cbReg").is(":checked")||(d=!1,$(".regulations").addClass("inputError"),b.push(MSG103),$("#btnFinish").bind("click",a))),d){$(this).hide(),$("#loader").show();var e=ARKIA2.WIZARD.getReservation(),f={reservationDetails:e,region:e.REGION};$.ajax({type:"POST",url:"webmethods/AjaxMethods.aspx/CreateReservation",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var f=e.d;if(0!=f.ReturnCode)333==f.ReturnCode?window.location=closeErrorPage:window.location=errorPage+"?er="+f.ReturnCode;else if(d=0!=f.ReservationSn,f.ReservationSn>0){var g={amountToPay:f.AmountToPay,currencyCode:f.CurrencyCode,pricePlans:f.PricePlans,reservationSn:f.ReservationSn};sessionStorage.setItem("paymentResult",JSON.stringify(g)),window.location="https://"+location.hostname+"/"+APPFolfer+"/"+paymentPage}else $("#btnFinish").bind("click",a),b=f.ErrorMessages.Value,f.ErrorReference.IsNull||$.each(f.ErrorReference.Value,function(a,b){switch(b){case"RGS05":ARKIA.WIZARD.FEES.reLoad=!0;break;case"PRD01":case"PRD02":ARKIA.WIZARD.HOTELS.reLoad=!0;break;case"PRD03":case"PRD04":ARKIA.WIZARD.FLIGHTS.reLoad=!0;break;case"PRD05":ARKIA.WIZARD.PRODUCTS.PRD05.reLoad=!0;break;case"PRD06":ARKIA.WIZARD.PRODUCTS.PRD06.reLoad=!0;break;case"PRD07":ARKIA.WIZARD.PRODUCTS.PRD07.reLoad=!0;break;case"PRD13":ARKIA.WIZARD.MEALS.PRD13.reLoad=!0;break;case"PRD09":case"PRD10":ARKIA.WIZARD.SHUTTLE.reLoad=!0}}),errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b),ARKIA.WIZARD.setError(c,!d),window.scrollTo(0,170),$("#btnFinish").show(),$("#loader").hide()},error:function(a,b,c){window.location=errorPage}})}else errorValues[c]=ARKIA.WIZARD.createErrorListWizard(b),ARKIA.WIZARD.setError(c,!d),window.scrollTo(0,170)};$("#btnFinish").bind("click",a)},summaryCtrl:["$scope",function(a){a.totalPrice="",a.feesItems=[],a.flightsItems=[],a.hotelsItems=[],a.productsItems=[],a.shuttlesItems=[],a.init=function(){var b=0,c=[],d=[],e=[];if(window.location.href.indexOf("dev")>-1){var f=ARKIA2.WIZARD.getReservation();console.log(f)}if(null!=ARKIA.WIZARD.FEES&&null!=ARKIA.WIZARD.FEES.temfees&&$.each(ARKIA.WIZARD.FEES.temfees,function(a,d){var e={name:d.LATIN_FIRST_NAME+" "+d.LATIN_LAST_NAME,price:d.SELECTED_FEE?d.SELECTED_FEE.PRICE:0,priceCurrency:d.SELECTED_FEE?d.SELECTED_FEE.PRICE_CURRENCY:"",feeName:d.SELECTED_FEE?d.SELECTED_FEE.AP_NAME:""};b+=e.price,c.push(e)}),a.feesItems=c,null!=ARKIA.WIZARD.HOTELS.roomsChecked){a.hotelsItems=[];for(var g in ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms){var h={ROOM_TYPE_NAME:ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].ROOM.ROOM_TYPE_NAME,BOARD:ARKIA.WIZARD.HOTELS.roomsChecked.boards.STR,PARTY_TYPE_NAME:ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].PARTY_TYPE.PARTY_TYPE_NAME,PRICE_FORMATTED:ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].PARTY_TYPE.PRICE_FORMATTED,PRICE_SELECTED:ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].PARTY_TYPE.PRICE_SELECTED,CUSTOMERS:[]};for(var i in ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].room_customers){var j=ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].room_customers[i].room_customer.LATIN_FIRST_NAME+" ";j+=ARKIA.WIZARD.HOTELS.roomsChecked.selectedRooms[g].room_customers[i].room_customer.LATIN_LAST_NAME,h.CUSTOMERS.push({NAME:j})}b+=h.PRICE_SELECTED,a.hotelsItems.push(h)}a.hotelsItems.length>0&&(a.hotelName=ARKIA.WIZARD.HOTELS.roomsChecked.hotel.HOTEL_NAME)}else a.hotelsItems=[];if(ARKIA.WIZARD.FLIGHTS.temPassflights)for(var k=0;k<2;k++){var l=0==k?ARKIA.WIZARD.FLIGHTS.temPassflights.itemsOB:ARKIA.WIZARD.FLIGHTS.temPassflights.itemsIB;$.each(l,function(a,c){var e,f=jQuery.grep(d,function(a){return a.ARR_STATION_NAME==c.ARR_STATION_NAME&&a.DEP_STATION_NAME==c.DEP_STATION_NAME});e=0==f.length?{ARR_STATION_NAME:c.ARR_STATION_NAME,DEP_STATION_NAME:c.DEP_STATION_NAME,DEP_DATE:0==k?startDate:endDate,FLIGHTS:[]}:f[0];var g={FLIGHT_DESC:$.trim(c.CARRIER_NAME)+c.FLIGHT_NO,DEP_TIME:c.DEP_TIME,PASSENGERS:[]};$.each(c.PASSENGERS,function(a,c){var d={name:c.OLD_SELECTED.LATIN_FIRST_NAME+" "+c.OLD_SELECTED.LATIN_LAST_NAME,price:c.PRICE,priceCurrency:c.PRICE_CURRENCY};b+=c.PRICE,g.PASSENGERS.push(d)}),e.FLIGHTS.push(g),0==f.length&&d.push(e)})}a.flightsItems=d;var m=ARKIA2.WIZARD.getPassengers();e=[],ARKIA.WIZARD.SHUTTLE.temproducts&&$.each(ARKIA.WIZARD.SHUTTLE.temproducts,function(a,c){$.each(c,function(a,c){if(c.CHILDREN_PRD_NO>0||c.ADULTS_PRD_NO>0){var d=c.ADULTS_PRD_NO>0?c.ADULTS_PRD_NO:0,f=c.CHILDREN_PRD_NO>0?c.CHILDREN_PRD_NO:0,g={name:c.AP_NAME,number:d+f,price:c.ADULT_PRICE*d+c.CHILD_PRICE*f,PASSENGERS:[]};$.each(c.PASSENGERS,function(a,b){var c=jQuery.grep(m,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO}),d={name:c[0].FULL_NAME,price:b.PRICE,priceCurrency:b.PRICE_CURRENCY};g.PASSENGERS.push(d)}),b+=g.price,g.price=g.price>0?eventsCurrency+g.price.formatMoney(0,".",","):"ללא עלות",e.push(g)}})}),a.shuttlesItems=e,e=[],ARKIA.WIZARD.MEALS.temproducts&&$.each(ARKIA.WIZARD.MEALS.temproducts,function(a,c){$.each(c,function(a,c){if(c.CHILDREN_PRD_NO>0||c.ADULTS_PRD_NO>0){var d=c.ADULTS_PRD_NO>0?c.ADULTS_PRD_NO:0,f=c.CHILDREN_PRD_NO>0?c.CHILDREN_PRD_NO:0,g={name:c.AP_NAME,number:d+f,price:c.ADULT_PRICE*d+c.CHILD_PRICE*f,PASSENGERS:[]};$.each(c.productsMeals,function(a,b){var c=jQuery.grep(m,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO}),d={name:c[0].FULL_NAME,price:b.PRICE,priceCurrency:b.PRICE_CURRENCY};g.PASSENGERS.push(d)}),b+=g.price,g.price=g.price>0?eventsCurrency+g.price.formatMoney(0,".",","):"ללא עלות",e.push(g)}})}),ARKIA.WIZARD.PRODUCTS.temproducts&&$.each(ARKIA.WIZARD.PRODUCTS.temproducts,function(a,c){$.each(c,function(a,c){if(c.CHILDREN_PRD_NO>0||c.ADULTS_PRD_NO>0){var d=c.ADULTS_PRD_NO>0?c.ADULTS_PRD_NO:0,f=c.CHILDREN_PRD_NO>0?c.CHILDREN_PRD_NO:0,g={name:c.AP_NAME,number:d+f,price:c.ADULT_PRICE*d+c.CHILD_PRICE*f,PASSENGERS:[]};$.each(c.PASSENGERS,function(a,b){var d=jQuery.grep(m,function(a){return a.CUSTOMER_NO==b.SELECT_CUSTOMER_NO}),e={name:d[0].FULL_NAME,price:"A"==d[0].AgeGroup?c.ADULT_PRICE:"C"==d[0].AgeGroup?c.CHILD_PRICE:c.INFANT_PRICE};e.price=e.price>0?eventsCurrency+e.price.formatMoney(0,".",","):"ללא עלות",g.PASSENGERS.push(e)}),b+=g.price,e.push(g)}})}),a.productsItems=e,a.totalPrice=b>0?eventsCurrency+b.formatMoney(0,".",","):""}}]},ARKIA.RESERVATION={CUSTOMER:null,COMPANIONS:null,FEES:null,HOTELS:null,HOTEL_COMMENT:null,FLIGHTS:null,AD_PRODUCTS:null,AD_PRODUCTS1:null,AD_PRODUCTS2:null,AD_PRODUCTS3:null,AD_PRODUCTS4:null,AD_PRODUCTS5:null,SHUTTLE:null,MEAL:null,REGION:""},ARKIA.CUSTOMER=function(){},ARKIA.CUSTOMER.prototype={LAST_NAME:"",CUSTOMER_NO:0,CUSTOMER_NOIsNull:!0,EMAIL:"",LATIN_LAST_NAME:"",JOB_TITLE_CODE:"",JOB_TITLE_CODEIsNull:!0,DOB:"",PHONES:{},FIRST_NAME:"",LATIN_FIRST_NAME:"",TITLE_CODE:"",TITLE_CODEIsNull:"",ID_NO:"",PASSPORT_NO:"",EXPIRE_DATE:"",ADDITIONAL_INFO1:"",ADDITIONAL_INFO2:"",ADDITIONAL_INFO3:"",COMMENT_1:"",COMMENT_2:"",COMMENT_3:"",COMMENT_4:"",init:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(this.CUSTOMER_NO=1,this.CUSTOMER_NOIsNull=!1,this.TITLE_CODE=a,this.TITLE_CODEIsNull=!1,this.JOB_TITLE_CODE=b,0!=b&&(this.JOB_TITLE_CODEIsNull=!1),this.ID_NO=c,this.FIRST_NAME=e,this.LAST_NAME=d,this.LATIN_LAST_NAME=f,this.LATIN_FIRST_NAME=g,this.EMAIL=h,null!=o&&(this.PASSPORT_NO=o,this.EXPIRE_DATE=p,this.EXPIRE_DATEIsNull=!1,this.DOB=q+""+(r<10?"0"+r:r)+(s<10?"0"+s:s)),this.PHONES=new ARKIA.PHONES,this.PHONES.Value=[],j){var A=new ARKIA.PHONE;A.init(j,i,"N"),this.PHONES.Value.push(A)}if(l){var B=new ARKIA.PHONE;B.init(l,k,"N"),this.PHONES.Value.push(B)}if(n){var C=new ARKIA.PHONE;C.init(n,m,"Y"),this.PHONES.Value.push(C)}this.ADDITIONAL_INFO1=t,this.ADDITIONAL_INFO2=u,this.ADDITIONAL_INFO3=v,this.COMMENT_1=w,this.COMMENT_2=x,this.COMMENT_3=y,this.COMMENT_4=z},initComp:function(a,b,c,d,e,f,g,h,i,j){this.CUSTOMER_NO=a,this.CUSTOMER_NOIsNull=!1,this.TITLE_CODE=b,this.TITLE_CODEIsNull=!1,this.JOB_TITLE_CODE=c,0!=c&&(this.JOB_TITLE_CODEIsNull=!1),this.LATIN_LAST_NAME=d,this.LATIN_FIRST_NAME=e,this.DOB=f+""+(g<10?"0"+g:g)+(h<10?"0"+h:h),null!=i&&(this.PASSPORT_NO=i,this.EXPIRE_DATE=j,this.EXPIRE_DATEIsNull=!1)}},ARKIA.PHONES=function(){},ARKIA.PHONES.prototype={Value:[]},ARKIA.PHONE=function(){},ARKIA.PHONE.prototype={FAX_YN:"",PHONE_NO:0,PHONE_NOIsNull:!0,AREA_CODE:0,AREA_CODEIsNull:!0,init:function(a,b,c){this.PHONE_NO=a,this.PHONE_NOIsNull=!1,this.AREA_CODE=b,this.AREA_CODEIsNull=!1,this.FAX_YN=c}},ARKIA.PRODUCTS=function(){},ARKIA.PRODUCTS.prototype={Value:[]},ARKIA.PRODUCT=function(){},ARKIA.PRODUCT.prototype={PRD_KEY:null,PASSENGERS:null,HT_PARTY_TYPE_CODE:0,HT_PARTY_TYPE_CODEIsNull:!0,HT_BOARD_BASIS_CODE:0,HT_BOARD_BASIS_CODEIsNull:!0,ADULTS_PRD_NO:0,ADULTS_PRD_NOIsNull:!0,CHILDREN_PRD_NO:0,CHILDREN_PRD_NOIsNull:!0,initFee:function(a,b){this.PRD_KEY=a,this.PASSENGERS=new ARKIA.PASSENGERS,this.PASSENGERS.Value=[],this.PASSENGERS.StatusArray=[],b&&(this.PASSENGERS.Value.push(b),this.PASSENGERS.StatusArray.push(1))},initHotel:function(a,b,c,d){this.PRD_KEY=a,this.HT_PARTY_TYPE_CODE=b,this.HT_PARTY_TYPE_CODEIsNull=!1,this.HT_BOARD_BASIS_CODE=c,this.HT_BOARD_BASIS_CODEIsNull=!1;var e=new ARKIA.PASSENGERS;e.Value=[],e.StatusArray=[],d&&$.each(d,function(a,b){e.Value.push(b),e.StatusArray.push(1)}),this.PASSENGERS=e},initFlight:function(a,b){this.PRD_KEY=a;var c=new ARKIA.PASSENGERS;c.Value=[],c.StatusArray=[],b&&$.each(b,function(a,b){c.Value.push(b),c.StatusArray.push(1)}),this.PASSENGERS=c},initProduct:function(a,b,c,d){if(this.PRD_KEY=a,b>0&&(this.ADULTS_PRD_NO=b,this.ADULTS_PRD_NOIsNull=!1),c>0&&(this.CHILDREN_PRD_NO=c,this.CHILDREN_PRD_NOIsNull=!1),d){var e=new ARKIA.PASSENGERS;e.Value=[],e.StatusArray=[],d&&$.each(d,function(a,b){e.Value.push(b),e.StatusArray.push(1)}),this.PASSENGERS=e}},initMeal:function(a,b,c){this.PRD_KEY=a,b>0&&(this.ADULTS_PRD_NO=b,this.ADULTS_PRD_NOIsNull=!1),c>0&&(this.CHILDREN_PRD_NO=c,this.CHILDREN_PRD_NOIsNull=!1)},initShuttle:function(a,b){this.PRD_KEY=a;var c=new ARKIA.PASSENGERS;c.Value=[],c.StatusArray=[],b&&$.each(b,function(a,b){c.Value.push(b),c.StatusArray.push(1)}),this.PASSENGERS=c}},ARKIA.PASSENGERS=function(){},ARKIA.PASSENGERS.prototype={Value:[],StatusArray:[]},ARKIA.COMPANIONS=function(){},ARKIA.COMPANIONS.prototype={Value:[]};var ARKIA2={WIZARD:{setCustomer:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){return cust=new ARKIA.CUSTOMER,cust.init(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A),ARKIA.RESERVATION.CUSTOMER=cust,ARKIA.RESERVATION.REGION=t,ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetCompanions:function(a){ARKIA.RESERVATION.COMPANIONS=null,a&&1==a&&(ARKIA.RESERVATION.FEES=null,ARKIA.RESERVATION.HOTELS=null,ARKIA.RESERVATION.HOTEL_COMMENT=null,ARKIA.RESERVATION.FLIGHTS=null,ARKIA.RESERVATION.AD_PRODUCTS=null,ARKIA.RESERVATION.AD_PRODUCTS1=null,ARKIA.RESERVATION.AD_PRODUCTS2=null,ARKIA.RESERVATION.AD_PRODUCTS3=null,ARKIA.RESERVATION.AD_PRODUCTS4=null,ARKIA.RESERVATION.AD_PRODUCTS5=null,ARKIA.RESERVATION.SHUTTLE=null,ARKIA.RESERVATION.MEAL=null)},addCompanions:function(a,b,c,d,e,f,g,h,i){ARKIA.RESERVATION.COMPANIONS||(ARKIA.RESERVATION.COMPANIONS=new ARKIA.COMPANIONS,ARKIA.RESERVATION.COMPANIONS.Value=[]);var j=new ARKIA.CUSTOMER;return j.initComp(ARKIA.RESERVATION.COMPANIONS.Value.length+2,a,b,c,d,e,f,g,h,i),ARKIA.RESERVATION.COMPANIONS.Value.push(j),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetFees:function(){ARKIA.RESERVATION.FEES=null},addFee:function(a,b){ARKIA.RESERVATION.FEES||(ARKIA.RESERVATION.FEES=new ARKIA.PRODUCTS,ARKIA.RESERVATION.FEES.Value=[]);var c=new ARKIA.PRODUCT;return c.initFee(a,b),ARKIA.RESERVATION.FEES.Value.push(c),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetHotels:function(){ARKIA.RESERVATION.HOTELS=null},initHotels:function(){ARKIA.RESERVATION.HOTELS||(ARKIA.RESERVATION.HOTELS=new ARKIA.PRODUCTS,ARKIA.RESERVATION.HOTELS.Value=[])},addHotelRoom:function(a,b,c,d){ARKIA.RESERVATION.HOTELS||(ARKIA.RESERVATION.HOTELS=new ARKIA.PRODUCTS,ARKIA.RESERVATION.HOTELS.Value=[]);var e=new ARKIA.PRODUCT;return e.initHotel(a,b,c,d),ARKIA.RESERVATION.HOTELS.Value.push(e),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},setHotelComment:function(a){ARKIA.RESERVATION.HOTEL_COMMENT=a},resetFlights:function(){ARKIA.RESERVATION.FLIGHTS=null},initFlights:function(){ARKIA.RESERVATION.FLIGHTS||(ARKIA.RESERVATION.FLIGHTS=new ARKIA.PRODUCTS,ARKIA.RESERVATION.FLIGHTS.Value=[])},AddFlight:function(a,b){ARKIA.RESERVATION.FLIGHTS||(ARKIA.RESERVATION.FLIGHTS=new ARKIA.PRODUCTS,ARKIA.RESERVATION.FLIGHTS.Value=[]);var c=new ARKIA.PRODUCT;return c.initFlight(a,b),ARKIA.RESERVATION.FLIGHTS.Value.push(c),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetProducts:function(a){switch(ARKIA.RESERVATION.AD_PRODUCTS=null,a){case 1:ARKIA.RESERVATION.AD_PRODUCTS1=null;break;case 2:ARKIA.RESERVATION.AD_PRODUCTS2=null;break;case 3:ARKIA.RESERVATION.AD_PRODUCTS3=null;break;case 4:ARKIA.RESERVATION.AD_PRODUCTS4=null;break;case 5:ARKIA.RESERVATION.AD_PRODUCTS5=null}},AddProduct:function(a,b,c,d,e){switch(a){case 1:ARKIA.RESERVATION.AD_PRODUCTS1||(ARKIA.RESERVATION.AD_PRODUCTS1=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS1.Value=[]);var f=new ARKIA.PRODUCT;f.initProduct(b,c,d,e),ARKIA.RESERVATION.AD_PRODUCTS1.Value.push(f);break;case 2:ARKIA.RESERVATION.AD_PRODUCTS2||(ARKIA.RESERVATION.AD_PRODUCTS2=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS2.Value=[]);var f=new ARKIA.PRODUCT;f.initProduct(b,c,d,e),ARKIA.RESERVATION.AD_PRODUCTS2.Value.push(f);break;case 3:ARKIA.RESERVATION.AD_PRODUCTS3||(ARKIA.RESERVATION.AD_PRODUCTS3=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS3.Value=[]);var f=new ARKIA.PRODUCT;f.initProduct(b,c,d,e),ARKIA.RESERVATION.AD_PRODUCTS3.Value.push(f);break;case 4:ARKIA.RESERVATION.AD_PRODUCTS4||(ARKIA.RESERVATION.AD_PRODUCTS4=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS4.Value=[]);var f=new ARKIA.PRODUCT;f.initProduct(b,c,d,e),ARKIA.RESERVATION.AD_PRODUCTS4.Value.push(f);break;case 5:ARKIA.RESERVATION.AD_PRODUCTS5||(ARKIA.RESERVATION.AD_PRODUCTS5=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS5.Value=[]);var f=new ARKIA.PRODUCT;f.initProduct(b,c,d,e),ARKIA.RESERVATION.AD_PRODUCTS5.Value.push(f)}return ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetMeal:function(){ARKIA.RESERVATION.MEAL=null},AddMeal:function(a,b,c){ARKIA.RESERVATION.MEAL||(ARKIA.RESERVATION.MEAL=new ARKIA.PRODUCTS,ARKIA.RESERVATION.MEAL.Value=[]);var d=new ARKIA.PRODUCT;return d.initMeal(a,b,c),ARKIA.RESERVATION.MEAL.Value.push(d),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},resetShuttle:function(){ARKIA.RESERVATION.SHUTTLE=null},initShuttle:function(){ARKIA.RESERVATION.SHUTTLE||(ARKIA.RESERVATION.SHUTTLE=new ARKIA.PRODUCTS,ARKIA.RESERVATION.SHUTTLE.Value=[])},AddShuttle:function(a,b){ARKIA.RESERVATION.SHUTTLE||(ARKIA.RESERVATION.SHUTTLE=new ARKIA.PRODUCTS,ARKIA.RESERVATION.SHUTTLE.Value=[]);var c=new ARKIA.PRODUCT;return c.initShuttle(a,b),ARKIA.RESERVATION.SHUTTLE.Value.push(c),ARKIA2.WIZARD.saveInSession(),ARKIA.RESERVATION},saveInSession:function(){sessionStorage.setItem("RESERVATION",JSON.stringify(ARKIA.RESERVATION))},getReservation:function(){var a=null;if(ARKIA.RESERVATION.CUSTOMER)a=ARKIA.RESERVATION;else{var b=sessionStorage.getItem("RESERVATION");b&&(ARKIA.RESERVATION=JSON.parse(b),ARKIA.RESERVATION.FEES=null,ARKIA.RESERVATION.HOTELS=null,ARKIA.RESERVATION.HOTEL_COMMENT=null,ARKIA.RESERVATION.FLIGHTS=null,ARKIA.RESERVATION.AD_PRODUCTS=null,ARKIA.RESERVATION.SHUTTLE=null,a=ARKIA.RESERVATION)}return null!=a&&(null==a.AD_PRODUCTS&&(a.AD_PRODUCTS=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS.Value=[]),null==a.AD_PRODUCTS1&&(a.AD_PRODUCTS1=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS1.Value=[]),null==a.AD_PRODUCTS2&&(a.AD_PRODUCTS2=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS2.Value=[]),null==a.AD_PRODUCTS3&&(a.AD_PRODUCTS3=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS3.Value=[]),null==a.AD_PRODUCTS4&&(a.AD_PRODUCTS4=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS4.Value=[]),null==a.AD_PRODUCTS5&&(a.AD_PRODUCTS5=new ARKIA.PRODUCTS,ARKIA.RESERVATION.AD_PRODUCTS5.Value=[]),null==a.SHUTTLE&&(a.SHUTTLE=new ARKIA.PRODUCTS,ARKIA.RESERVATION.SHUTTLE.Value=[]),null==a.MEAL&&(a.MEAL=new ARKIA.PRODUCTS,ARKIA.RESERVATION.MEAL.Value=[]),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.AD_PRODUCTS1.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.AD_PRODUCTS2.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.AD_PRODUCTS3.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.AD_PRODUCTS4.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.AD_PRODUCTS5.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.SHUTTLE.Value),a.AD_PRODUCTS.Value=$.merge(a.AD_PRODUCTS.Value,a.MEAL.Value)),a},getPassengers:function(){var a=[],b=ARKIA.RESERVATION.CUSTOMER;return b.AgeGroup="A",b.FULL_NAME=b.LATIN_FIRST_NAME+" "+b.LATIN_LAST_NAME,a.push(b),ARKIA.RESERVATION.COMPANIONS&&$.each(ARKIA.RESERVATION.COMPANIONS.Value,function(b,c){c.AgeGroup=ARKIA2.WIZARD.getAgeGroup(c),c.FULL_NAME=c.LATIN_FIRST_NAME+" "+c.LATIN_LAST_NAME,a.push(c)}),a},getAgeByDate:function(a){var b=startDate.split("/");eventStartDate=new Date(b[2],b[1]-1,b[0]);var c=a.substring(0,4),d=a.substring(4,6),e=a.substring(6,8),f=new Date(c,d-1,e),g=eventStartDate.getFullYear()-f.getFullYear(),h=eventStartDate.getMonth()-f.getMonth();return(h<0||0===h&&eventStartDate.getDate()<f.getDate())&&g--,g},getAgeGroup:function(a){if(1==a.CUSTOMER_NO)return"A";var b=ARKIA2.WIZARD.getAgeByDate(a.DOB);return b<ChildAgeStart?"I":b<ChildAgeEnd?"C":"A"},getAgeGroupRegType:function(a){if(1==a.CUSTOMER_NO)return"A";var b=ARKIA2.WIZARD.getAgeByDate(a.DOB);return b<2?"I":b<22?"C":"A"},getAgeGroupCountRegType:function(){var a=1,b=0,c=0;return null!=ARKIA.RESERVATION.COMPANIONS&&null!=ARKIA.RESERVATION.COMPANIONS.Value&&$.each(ARKIA.RESERVATION.COMPANIONS.Value,function(d,e){"I"==ARKIA2.WIZARD.getAgeGroupRegType(e)?c++:"C"==ARKIA2.WIZARD.getAgeGroupRegType(e)?b++:a++}),{adults:a,children:b,infants:c}},getAgeGroupCount:function(){var a=1,b=0,c=0;return null!=ARKIA.RESERVATION.COMPANIONS&&null!=ARKIA.RESERVATION.COMPANIONS.Value&&$.each(ARKIA.RESERVATION.COMPANIONS.Value,function(d,e){"I"==ARKIA2.WIZARD.getAgeGroup(e)?c++:"C"==ARKIA2.WIZARD.getAgeGroup(e)?b++:a++}),{adults:a,children:b,infants:c}}}};